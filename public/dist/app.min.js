"use strict";angular.module("app.controllers",[]),angular.module("app.directives",[]),angular.module("app.resources",[]),angular.module("app.services",[]),angular.module("app.filters",[]),angular.module("app.routes",[]),angular.module("app.views",[]),angular.module("app.auth",[]),angular.module("app",["ngResource","ngSanitize","satellizer","ui.bootstrap","ui.bootstrap.tpls","ui.router","ui.select","app.controllers","app.directives","app.resources","app.services","app.filters","app.routes","app.views","app.auth"]);
"use strict";angular.module("app.auth").config(["$authProvider",function(t){t.loginUrl="/api/auth"}]).run(["$rootScope","$q","$state","$auth","$store","$load","$invalidate","$location","$title","$pretend",function(t,a,n,e,o,i,l,d,u,c){t.$on("$stateChangeStart",function(o,i,s,h,r){o.preventDefault(),i.data&&i.data.title&&u(i.data.title),t.bodyClass="page-"+i.name;var g=l.load();g.length&&g.push(c.wait(1e3)),t.loader=!0,a.all(g).then(function(){var a=i.data&&i.data.conditions?i.data.conditions:[],o=null;a.forEach(function(t){"auth"==t&&(e.isAuthenticated()||(o="login")),"guest_only"==t&&e.isAuthenticated()&&(o="home"),"manager_only"==t&&(e.isAuthenticated()?2!==e.getPayload().admin&&(o="home"):o="login"),"staff_only"==t&&(e.isAuthenticated()?e.getPayload().admin||(o="home"):o="login"),"student_only"==t&&(e.isAuthenticated()?e.getPayload().admin&&(o="home"):o="login")}),o&&(console.log("kicked to",o),t.loader=!1,d.path(o)),o||n.go(i.name,s,{notify:!1}).then(function(){t.loader=!1,t.$broadcast("$stateChangeSuccess",i,s,h,r)})})})}]);
"use strict";angular.module("app.routes").config(["$stateProvider","$urlRouterProvider","$locationProvider",function(t,e,a){a.hashPrefix(""),a.html5Mode(!0),e.otherwise("/");var n={home:{url:"/",templateUrl:"components/home/home.html",controller:"homeCtrl",data:{conditions:["auth"],title:"Home"}},edit_profile:{url:"/home/edit_profile",templateUrl:"components/manage/users/views/edit.html",controller:"userEditCtrl",data:{conditions:["auth"],title:"Edit Profile",edit_profile:!0}},register:{url:"/register",templateUrl:"components/guest/register/register.html",controller:"registerCtrl",data:{conditions:["guest_only"],title:"Register"}},login:{url:"/login",templateUrl:"components/guest/login/login.html",controller:"loginCtrl",data:{conditions:["guest_only"],title:"Login"}},logout:{url:"/logout",controller:["$auth","$location","$store",function(t,e,a){t.logout().then(function(){a.user={},a.resetBooking(),e.path("login")})}]},make_booking:{url:"/book",templateUrl:"components/booking/make/make.html",controller:"makeCtrl",data:{conditions:["auth"],title:"Book Equipment"}},confirm_booking:{url:"/book/confirm",templateUrl:"components/booking/confirm/confirm.html",controller:"confirmCtrl",data:{conditions:["auth"],title:"Confirm booking",crumb_parent:"make_booking"}},success_booking:{url:"/book/success",templateUrl:"components/booking/success/success.html",controller:"successCtrl",data:{conditions:["auth"],title:"Booking Made"}},manage_bookings:{url:"/bookings?user&group&after&before&closed&returned&booked&issued&overdue&limit&page",templateUrl:"components/booking/manage/manage.html",controller:"bookingsManageCtrl",data:{conditions:["auth","staff_only"],title:"All Bookings"}},view_booking:{url:"/booking/:id",templateUrl:"components/booking/view/view.html",controller:"viewBookingCtrl",data:{conditions:["auth"],title:"View Booking",crumb_parent:"manage_bookings"}},issue_booking:{url:"/booking/:id/issue",templateUrl:"components/booking/issue/issue.html",controller:"issueCtrl",data:{conditions:["auth","staff_only"],title:"Issue Equipment",crumb_parent:"view_booking"}},return_booking:{url:"/booking/:id/return",templateUrl:"components/booking/return/return.html",controller:"returnCtrl",data:{conditions:["auth","staff_only"],title:"Return Equipment",crumb_parent:"view_booking"}},edit_booking:{url:"/booking/:id/edit",templateUrl:"components/booking/edit/edit.html",controller:"editBookingCtrl",data:{conditions:["auth","staff_only"],title:"Edit Booking",crumb_parent:"view_booking"}},manage:{url:"/manage",templateUrl:"components/manage/manage/manage.html",controller:"manageCtrl",data:{conditions:["auth","staff_only"],title:"Manage"}},manage_users:{url:"/manage/user",templateUrl:"components/manage/users/views/manage.html",controller:"userManageCtrl",data:{conditions:["auth","staff_only"],crumb_parent:"manage",title:"All Users"}},new_user:{url:"/manage/user/new?class",templateUrl:"components/manage/users/views/new.html",controller:"userNewCtrl",data:{conditions:["auth","staff_only"],crumb_parent:"manage_users",title:"New User"}},view_user:{url:"/manage/user/:id",templateUrl:"components/manage/users/views/view.html",controller:"userViewCtrl",data:{conditions:["auth","staff_only"],crumb_parent:"manage_users",title:"View User"}},edit_user:{url:"/manage/user/:id/edit",templateUrl:"components/manage/users/views/edit.html",controller:"userEditCtrl",data:{conditions:["auth","staff_only"],crumb_parent:"view_user",title:"Edit User"}},new_note:{url:"/manage/user/:id/note/new",templateUrl:"components/manage/users/views/new_note.html",controller:"userNewNoteCtrl",data:{conditions:["auth","staff_only"],crumb_parent:"view_user",title:"New Note"}},view_note:{url:"/manage/user/:id/note/:id2",templateUrl:"components/manage/users/views/view_note.html",controller:"userViewNoteCtrl",data:{conditions:["auth","staff_only"],crumb_parent:"view_user",title:"View Note"}},edit_note:{url:"/manage/user/:id/note/:id2/edit",templateUrl:"components/manage/users/views/edit_note.html",controller:"userEditNoteCtrl",data:{conditions:["auth","staff_only"],crumb_parent:"view_user",title:"Edit Note"}},manage_class_types:{url:"/manage/class_type",templateUrl:"components/manage/class_types/views/manage.html",controller:"classTypeManageCtrl",data:{conditions:["auth","manager_only"],crumb_parent:"manage",title:"All Class Types"}},new_class_type:{url:"/manage/class_type/new",templateUrl:"components/manage/class_types/views/new.html",controller:"classTypeNewCtrl",data:{conditions:["auth","manager_only"],crumb_parent:"manage_class_types",title:"New Class Type"}},view_class_type:{url:"/manage/class_type/:id",templateUrl:"components/manage/class_types/views/view.html",controller:"classTypeViewCtrl",data:{conditions:["auth","manager_only"],crumb_parent:"manage_class_types",title:"View Class Type"}},edit_class_type:{url:"/manage/class_type/:id/edit",templateUrl:"components/manage/class_types/views/edit.html",controller:"classTypeEditCtrl",data:{conditions:["auth","manager_only"],crumb_parent:"view_class_type",title:"Edit Class Type"}},manage_class:{url:"/manage/class",templateUrl:"components/manage/classes/views/manage.html",controller:"classManageCtrl",data:{conditions:["auth","manager_only"],crumb_parent:"manage",title:"All Classes"}},new_class:{url:"/manage/class/new?type",templateUrl:"components/manage/classes/views/new.html",controller:"classNewCtrl",data:{conditions:["auth","manager_only"],crumb_parent:"manage_class",title:"New Class"}},view_class:{url:"/manage/class/:id",templateUrl:"components/manage/classes/views/view.html",controller:"classViewCtrl",data:{conditions:["auth","manager_only"],crumb_parent:"manage_class",title:"View Class"}},edit_class:{url:"/manage/class/:id/edit",templateUrl:"components/manage/classes/views/edit.html",controller:"classEditCtrl",data:{conditions:["auth","manager_only"],crumb_parent:"view_class",title:"Edit Class"}},allow_products_for_class:{url:"/manage/class/:id/allowed_products",templateUrl:"components/manage/classes/views/allowed_products.html",controller:"classProductCtrl",data:{conditions:["auth","manager_only"],crumb_parent:"view_class",title:"Allow Product"}},manage_product_type:{url:"/manage/product_type",templateUrl:"components/manage/product_types/views/manage.html",controller:"productTypeManageCtrl",data:{conditions:["auth","manager_only"],crumb_parent:"manage",title:"All Product Types"}},new_product_type:{url:"/manage/product_type/new",templateUrl:"components/manage/product_types/views/new.html",controller:"productTypeNewCtrl",data:{conditions:["auth","manager_only"],crumb_parent:"manage_product_type",title:"New Product Type"}},view_product_type:{url:"/manage/product_type/:id",templateUrl:"components/manage/product_types/views/view.html",controller:"productTypeViewCtrl",data:{conditions:["auth","manager_only"],crumb_parent:"manage_product_type",title:"View Product Type"}},edit_product_type:{url:"/manage/product_type/:id/edit",templateUrl:"components/manage/product_types/views/edit.html",controller:"productTypeEditCtrl",data:{conditions:["auth","manager_only"],crumb_parent:"view_product_type",title:"Edit Product Type"}},manage_product:{url:"/manage/product",templateUrl:"components/manage/products/views/manage.html",controller:"productManageCtrl",data:{conditions:["auth","manager_only"],crumb_parent:"manage",title:"All Products"}},new_product:{url:"/manage/product/new?type",templateUrl:"components/manage/products/views/new.html",controller:"productNewCtrl",data:{conditions:["auth","manager_only"],crumb_parent:"manage_product",title:"New Product"}},view_product:{url:"/manage/product/:id",templateUrl:"components/manage/products/views/view.html",controller:"productViewCtrl",data:{conditions:["auth","manager_only"],crumb_parent:"manage_product",title:"View Product"}},edit_product:{url:"/manage/product/:id/edit",templateUrl:"components/manage/products/views/edit.html",controller:"productEditCtrl",data:{conditions:["auth","manager_only"],crumb_parent:"view_product",title:"Edit Product"}},manage_unit:{url:"/manage/unit",templateUrl:"components/manage/units/views/manage.html",controller:"unitManageCtrl",data:{conditions:["auth","manager_only"],crumb_parent:"manage",title:"All Units"}},new_unit:{url:"/manage/unit/new?product",templateUrl:"components/manage/units/views/new.html",controller:"unitNewCtrl",data:{conditions:["auth","manager_only"],crumb_parent:"manage_unit",title:"New Unit"}},view_unit:{url:"/manage/unit/:id",templateUrl:"components/manage/units/views/view.html",controller:"unitViewCtrl",data:{conditions:["auth","manager_only"],crumb_parent:"manage_unit",title:"View Unit"}},edit_unit:{url:"/manage/unit/:id/edit",templateUrl:"components/manage/units/views/edit.html",controller:"unitEditCtrl",data:{conditions:["auth","manager_only"],crumb_parent:"view_unit",title:"Edit Unit"}}};for(var o in n){var l=n[o];l.data&&l.data.crumb_parent&&(l.data.crumb_parent=n[l.data.crumb_parent]),t.state(o,l)}}]);
"use strict";angular.module("app.controllers").controller("confirmCtrl",["$scope","$store","$location","$http","$invalidate",function(o,t,n,i,e){t.booking.pickup_at||n.path("/book"),window.scope=o,o.user=t.user,o.booking=t.booking,o.allowedProducts=[],o.overallAllowed=!0,o.product=function(o){return t.get("products",o)},_.forEach(o.booking.products,function(t){o.booking.pickup_at=moment(o.booking.pickup_at).startOf("day")._d,i.post("/api/product/"+t.id+"/check/",{pickup_at:o.booking.pickup_at,due_at:o.booking.due_at}).then(function(t){t.data.allowed?o.allowedProducts.push(parseInt(t.data.id)):o.overallAllowed=!1})}),o.allowed=function(t){return o.allowedProducts.indexOf(t)>=0},o.confirm=function(){o.user.can_book&&(t.booking.pickup_at=new Date(t.booking.pickup_at),t.booking.due_at=new Date(t.booking.due_at),i.post("/api/booking",t.booking).then(function(o){t.resetBooking(),n.path("/book/success")}))},o.disableSubmit=function(){return!(o.overallAllowed&&o.booking.due_at&&o.booking.pickup_at&&o.booking.products.length)}}]);
"use strict";angular.module("app.controllers").controller("editBookingCtrl",["$scope","$stateParams","$store","$location","$http","$invalidate",function(o,t,n,i,u,e){o.user=n.user,o.booking=n.get("bookings",t.id),o.dateOptions={showWeeks:!1,format:"d MMM yyyy",minDate:new Date},o.select2Options={selectOnClose:!0},o.openPickup=function(){o.openPickupDate=!o.openPickupDate},o.openDue=function(){o.openDueDate=!o.openDueDate},o.save=function(){1==o.booking._priority&&(o.booking.products=[],_.forEach(o.products,function(t){t._quantity&&o.booking.products.push({id:t.id,quantity:t._quantity})}),u.put("/api/booking/"+o.booking.id,o.booking).then(function(t){e.add("bookings"),i.path("/booking/"+o.booking.id)}))},o.max=function(o){return o._max},o.group=n.get("groups",n.user.group_id),o.group?(o.products=o.group.allowed_products,_.forEach(o.products,function(o){o._max=o.pivot.quantity,o._quantity=void 0})):(o.products=n.products,_.forEach(o.products,function(o){o._max=o.units.length,o._quantity=void 0})),o.booking.products.forEach(function(t){var n=_.find(o.products,function(o){return o.id==t.id});n._quantity||(n._quantity=0),n._quantity+=1})}]);
"use strict";angular.module("app.controllers").controller("issueCtrl",["$scope","$stateParams","$store","$location","$http","$invalidate","$load",function(o,n,e,i,t,s,u){o.booking=e.get("bookings",n.id),o.errors=[],o.booking||(o.booking=u.booking(n.id),console.log(o.booking)),o.booking.$promise.then(function(o){},function(n){o.errors.push({message:n.data.error})}),o.dateOptions={showWeeks:!1,format:"d MMM yyyy",minDate:new Date},o.select2Options={selectOnClose:!0},o.openPickup=function(){o.openPickupDate=!o.openPickupDate},o.openDue=function(){o.openDueDate=!o.openDueDate},o.issue=function(){var n=o.booking.products.reduce(function(o,n){return o&&!!n.unit},!0);n?(o.booking.taken_at=new Date,o.booking.issued_by_id=e.user.id,t.put("/api/booking/"+o.booking.id,o.booking).then(function(n){e.bookings=_.map(e.bookings,function(o,i){o.id==n.id&&(e.bookings[i]=n)}),i.path("/booking/"+o.booking.id)})):o.errors.push({message:"You need to assign a unit for every product."})},o.isntSelected=function(n){return function(e,i,t){var s=!0;return _.forEach(o.booking.products,function(o){n!=o&&o.unit&&o.unit.id==e.id&&(s=!1)}),s}}}]);
"use strict";angular.module("app.controllers").controller("makeCtrl",["$scope","$store","$location",function(o,t,n){o.dateOptions={showWeeks:!1,format:"d MMM yyyy",minDate:new Date},t.user.admin?o.users=t.users:o.users=[],o.openPickup=function(){o.openPickupDate=!o.openPickupDate},o.openDue=function(){o.openDueDate=!o.openDueDate},o.user=t.user,o.booking=t.booking,o.booking._user||(o.booking._user=t.user),o.booking.pickup_at?o.booking.pickup_at.valueOf()>o.booking.due_at.valueOf()&&(o.booking.pickup_at=new Date,o.booking.due_at=""):o.booking.pickup_at=new Date,o.reset=function(){t.resetBooking(),o.booking.pickup_at=new Date,o.booking.due_at=void 0,o.booking._user=t.user,_.forEach(o.products,function(o){o._quantity=void 0})},o.book=function(){o.createBooking(),n.path("/book/confirm")},o.createBooking=function(){var n=[];_.forEach(o.products,function(o){parseInt(o._quantity)>0&&n.push({id:o.id,quantity:o._quantity})}),t.setBooking({due_at:o.booking.due_at,pickup_at:o.booking.pickup_at,products:n,_user:o.booking._user}),console.log(t.booking)},o.checkAgainstMax=function(t){o.max(t);t._quantity>t._max&&(t._quantity=1),void 0===t._quantity&&(t._quantity=t._max)},o.max=function(o){return o._max},t.user.group_id?(o.group=t.get("groups",t.user.group_id),o.group&&(o.products=o.group.allowed_products,_.forEach(o.products,function(o){o._max=o.pivot.quantity}))):(o.products=t.products,_.forEach(o.products,function(t){if(t._max=t.units.length,o.booking.products&&o.booking.products.length){var n=_.find(o.booking.products,function(o){return o.id==t.id});n&&(t._quantity=n.quantity)}}))}]);
"use strict";angular.module("app.controllers").controller("bookingsManageCtrl",["$scope","$store","$load","$stateParams","Booking",function(e,o,r,t,a){function s(o){var t=r.bookings(100,o);t.$promise.then(function(r){_.forEach(r,function(o){return e.bookings.push(o)}),100==r.length?s(o+1):i()})}function i(){o.bookings=e.bookings,e.bookings=[],_.forEach(o.bookings,function(o){e.bookings.push({id:o.id,user:{name:o.user.name,group:{code:o.user.group?o.user.group.code:""}},closed_at:o.closed_at,created_at:o.created_at,_status:o._status,_overdue:o._overdue,_priority:o._priority})}),e.advFilter.apply()}console.log("stateParams",t),window.$scope=e,e.users=o.users,e.groups=o.groups,e.bookings=[],o.bookings=[],s(1),e.dateOptions={showWeeks:!1,format:"d MMM yyyy"},e.openAfterDate=function(){e.openAfterDateControl=!e.openAfterDateControl,e.filterUseAfterDate=!0},e.openBeforeDate=function(){e.openBeforeDateControl=!e.openBeforeDateControl,e.filterUseBeforeDate=!0},e.advFilter={open:!1,props:{},defaults:{after:null,before:null,user:null,overdue:!0,closed:!1,issued:!0,booked:!0,limit:10},toggleOpen:function(){e.advFilter.open=!e.advFilter.open},clear:function(){e.advFilter.props=_.clone(e.advFilter.defaults),e.advFilter.apply()},clearUser:function(){e.advFilter.props.user=null},importFromQueryString:function(r){r.user&&(e.advFilter.props.user=o.get("users",parseInt(r.user))),e.advFilter.apply()},importFromLocalStorage:function(){localStorage.advFilter&&(e.advFilter.props=_.merge(e.advFilter.props,JSON.parse(localStorage.advFilter))),e.advFilter.apply()},apply:function(){if(0!==e.advFilter.props.limit){var r=[],t=[];_.forEach(o.bookings,function(o){var t=!0;e.advFilter.props.after&&o.created_at.valueOf()<e.advFilter.props.after.valueOf()&&(t=!1),e.advFilter.props.before&&o.created_at.valueOf()>e.advFilter.props.before.valueOf()&&(t=!1),e.advFilter.props.user&&o.user.id!==e.advFilter.props.user.id&&(t=!1),t&&r.push(o)}),_.forEach(r,function(o){var r=!1;e.advFilter.props.closed&&o.closed_at&&(r=!0),e.advFilter.props.issued&&(!o.taken_at||o.closed_at||o._overdue||(r=!0)),e.advFilter.props.overdue&&o.taken_at&&o._overdue&&!o.closed_at&&(r=!0),e.advFilter.props.booked&&(o.taken_at||(r=!0)),r&&t.push(o)}),e.bookings=t,e.advFilter.open=!1,localStorage.setItem("advFilter",JSON.stringify(e.advFilter.props))}}},e.advFilter.importFromLocalStorage(),e.advFilter.importFromQueryString(t)}]);
"use strict";angular.module("app.controllers").controller("returnCtrl",["$scope","$stateParams","$store","$location","$http","$invalidate","$load",function(o,n,t,i,e,r,u){o.errors=[],o.booking=t.get("bookings",n.id),o.booking||(o.booking=u.booking(n.id),console.log(o.booking)),o.booking.$promise.then(function(o){o.products.map(function(o){o.returned=!!o.pivot.returned_at,o.locked=!!o.pivot.returned_at})},function(n){o.errors.push({message:n.data.error})}),o.unit=function(o){return t.get("units",o)},o.close=function(){o.booking.products.length==_.filter(o.booking.products,function(o){return o.returned}).length&&(o.booking.closed_at=new Date,o.booking.closed_by_id=t.user.id),_.forEach(o.booking.products,function(o){o.returned&&(o.returned_at=new Date)}),e.put("/api/booking/"+o.booking.id,o.booking).then(function(n){t.bookings=_.map(t.bookings,function(o,i){o&&o.id==n.id&&(t.bookings[i]=n)}),i.path("/booking/"+o.booking.id)})}}]);
"use strict";angular.module("app.controllers").controller("successCtrl",["$scope","$store",function(o,r){}]);
"use strict";angular.module("app.controllers").controller("viewBookingCtrl",["$scope","$stateParams","$store","$location","$http","$invalidate","Booking","$prepare","$merge",function(o,e,n,t,r,i,s,a,u){o.booking=n.get("bookings",e.id),o.user=n.user,o.errors=[],o.unit=function(o){return n.get("units",o)},o.booking?o.return_difference=moment().diff(new Date(o.booking.closed_at),"hours"):(o.booking=s.get({id:e.id,"with":"user|products",token:localStorage.satellizer_token}),o.booking.$promise.then(a.booking).then(function(e){u.bookings([e]),o.return_difference=moment().diff(new Date(o.booking.closed_at),"hours"),console.log("loaded",e.products)},function(e){o.errors.push({message:e.data.error})})),o["delete"]=function(){var e=confirm("Are you sure you want to delete this?");e&&r["delete"]("/api/booking/"+o.booking.id).then(function(){t.path("/bookings")})}}]);
"use strict";angular.module("app.controllers").controller("loginCtrl",["$scope","$auth","$store","$state","$location","$invalidate","$load","User",function(r,a,o,e,n,t,i,l){function s(){r.error=""}r.$watch("email",s),r.$watch("password",s),r.login=function(){if(!r.email||!r.password)return!1;var e={email:r.email,password:r.password};a.login(e).then(function(r){o.user=new l(r.data.user),i.trigger("user",o.user),t.all(),n.path("/home")})["catch"](function(a){console.log(a.data),"invalid_credentials"==a.data.error?r.error="Email or password is invalid.":r.error="Unknown error"})}}]);
"use strict";angular.module("app.controllers").controller("registerCtrl",["$scope","$auth","$store","$state","$location","User",function(e,o,r,n,a,s){e.dateOptions={showWeeks:!1,format:"d MMM yyyy"},e.openDob=function(){e.openDobDate=!e.openDobDate},e.groups=r.groups,e.selected={},e.register=function(){var n=new s;n.dob=e.dob,n.name=e.name,n.email=e.email,n.phone=e.phone,n.group_id=e.selected.group.id,n.password=e.password,n.id_number=e.id_number,n.$save().then(function(n){var s={name:n.name,password:e.password};o.login(s).then(function(e){r.user=e.data.user,a.path("/home")})["catch"](function(o){"invalid_credentials"==o.data.error?e.error="Username or password is invalid.":e.error="Unknown error"})})["catch"](function(e){console.log("save err",e)})}}]);
"use strict";angular.module("app.controllers").controller("homeCtrl",["$scope","$rootScope","$store","$stateParams","$prepare","User","Booking",function(o,e,r,s,t,n,u){o.user=r.user,o.bookings=u.query({user:o.user.id}),o.bookings.$promise.then(t.bookings)}]);
"use strict";angular.module("app.controllers").controller("classTypeEditCtrl",["$scope","$stateParams","$store","$location","$invalidate","Group_Type",function(t,e,p,a,o,s){t.type=_.clone(p.get("group_types",e.id)),t.save=function(){s.update({id:t.type.id},t.type).$promise.then(function(e){o.add("group_types"),a.path("/manage/class_type/"+t.type.id)})}}]);
"use strict";angular.module("app.controllers").controller("classTypeManageCtrl",["$scope","$store",function(e,o){e.group_types=o.group_types}]);
"use strict";angular.module("app.controllers").controller("classTypeNewCtrl",["$scope","$stateParams","$store","$location","$invalidate","Group_Type",function(e,a,o,t,n,s){e.save=function(){var a=new s;a.code=e.code,a.name=e.name,a.$save().then(function(e){n.add(["group_types","groups"]),t.path("/manage/class_type")})}}]);
"use strict";angular.module("app.controllers").controller("classTypeViewCtrl",["$scope","$stateParams","$store","$location","$invalidate",function(e,t,o,a,n){e.type=o.get("group_types",t.id),window.scope=e,e["delete"]=function(){var t=confirm("Are you sure you want to delete this?");t&&e.type.$delete().then(function(){n.add("group_types"),a.path("/manage/class_type")})}}]);
"use strict";angular.module("app.controllers").controller("classEditCtrl",["$scope","$stateParams","$store","$location","$invalidate","Group",function(t,e,o,r,u,s){t.group=_.clone(o.get("groups",e.id)),t.users=o.users,t.types=o.group_types,t.selected={type:o.get("group_types",t.group.type.id),tutors:t.group.tutors},t.tutorRole=function(t,e,o){return t.admin>0},t.addTutor=function(){t.selected.tutors.push({})},t.removeTutor=function(e){t.selected.tutors=_.reject(t.selected.tutors,function(t){return t.id==e.id}),t.selected.tutors.length||t.addTutor()},t.save=function(){t.group.group_type_id=t.selected.type.id,t.group.tutors=[],_.forEach(t.selected.tutors,function(e){e.id&&t.group.tutors.push(e.id)}),s.update({id:t.group.id},t.group).$promise.then(function(e){u.add(["groups","users"]),r.path("/manage/class/"+t.group.id)})}}]);
"use strict";angular.module("app.controllers").controller("classManageCtrl",["$scope","$store",function(o,r){o.groups=r.groups}]);
"use strict";angular.module("app.controllers").controller("classNewCtrl",["$scope","$stateParams","$store","$location","$invalidate","Group",function(e,t,o,s,r,u){var c=t.type;e.users=o.users,e.types=o.group_types,e.selected={type:{},tutors:[{}]},c&&(e.selected.type=o.get("group_types",{code:c}),console.log(e.selected.type)),e.tutorRole=function(e,t,o){return e.admin>0},e.addTutor=function(){e.selected.tutors.push({})},e.removeTutor=function(t){e.selected.tutors=_.reject(e.selected.tutors,function(e){return e.id==t.id}),e.selected.tutors.length||e.addTutor()},e.save=function(){var t=new u;t.code=e.code,t.group_type_id=e.selected.type.id,t.tutors=[],_.forEach(e.selected.tutors,function(e){e.id&&t.tutors.push(e.id)}),t.$save().then(function(e){r.add(["groups","users"]),s.path("/manage/class")})}}]);
"use strict";angular.module("app.controllers").controller("classProductCtrl",["$scope","$stateParams","$store","$location","$http","$timeout","$invalidate",function(o,t,a,d,u,l,i){a.groups.$promise.then(function(){o.group=_.clone(a.get("groups",t.id)),o.products=a.products,_.forEach(o.products,function(t){_.forEach(o.group.allowed_products,function(o){o.id==t.id&&(t._allowed=!0,t._quantity=o.pivot.quantity,t._days_allowed=o.pivot.days_allowed)}),t._quantity||(t._quantity=1),t._days_allowed||(t._days_allowed=1)})}),l(function(){o.update=function(t){t._allowed&&(o.saved=!1,u.put("/api/product/"+t.id+"/allow/"+o.group.id,{quantity:t._quantity,days_allowed:t._days_allowed}).then(function(t){o.saved=!0,i.add(["groups","units"])}))}},1e3),o.allow=function(t){o.saved=!1,t._allowed?u.post("/api/product/"+t.id+"/allow/"+o.group.id,{quantity:t._quantity,days_allowed:t._days_allowed}).then(function(t){o.saved=!0,i.add(["groups","units"])}):u.post("/api/product/"+t.id+"/disallow/"+o.group.id).then(function(t){o.saved=!0,i.add(["groups","units"])})}}]);
"use strict";angular.module("app.controllers").controller("classViewCtrl",["$scope","$stateParams","$store","$location","$invalidate",function(e,t,o,a,r){e.group=o.get("groups",t.id),e["delete"]=function(){var t=confirm("Are you sure you want to delete this?");t&&e.group.$delete().then(function(){r.add("groups"),a.path("/manage/class")})}}]);
"use strict";angular.module("app.controllers").controller("manageCtrl",["$scope","$store",function(r,e){r.user=e.user,r.store=e}]);
"use strict";angular.module("app.controllers").controller("productTypeEditCtrl",["$scope","$stateParams","$store","$location","$invalidate","Product_Type",function(t,e,o,p,a,d){t.type=_.clone(o.get("product_types",e.id)),t.save=function(){d.update({id:t.type.id},t.type).$promise.then(function(e){a.add("product_types"),p.path("/manage/product_type/"+t.type.id)})}}]);
"use strict";angular.module("app.controllers").controller("productTypeManageCtrl",["$scope","$store",function(t,o){t.product_types=o.product_types}]);
"use strict";angular.module("app.controllers").controller("productTypeNewCtrl",["$scope","$stateParams","$store","$location","$invalidate","Product_Type",function(e,t,a,o,n,c){e.save=function(){var t=new c;t.code=e.code,t.name=e.name,t.$save().then(function(e){n.add("product_types"),o.path("/manage/product_type")})}}]);
"use strict";angular.module("app.controllers").controller("productTypeViewCtrl",["$scope","$stateParams","$store","$invalidate","$location",function(t,e,o,r,a){t.type=o.get("product_types",e.id),t["delete"]=function(){var e=confirm("Are you sure you want to delete this?");e&&t.type.$delete().then(function(){r.add("product_types"),a.path("/manage/product_type")})}}]);
"use strict";angular.module("app.controllers").controller("productEditCtrl",["$scope","$stateParams","$store","$location","$invalidate","Product",function(t,e,d,o,p,c){t.product=d.get("products",e.id),t.types=_.clone(d.product_types),t.selected={type:d.get("product_types",t.product.type.id)},t.save=function(){t.product.type_id=t.selected.type.id,c.update({id:t.product.id},t.product).$promise.then(function(e){p.add("products"),o.path("/manage/product/"+t.product.id)})}}]);
"use strict";angular.module("app.controllers").controller("productManageCtrl",["$scope","$store",function(o,r){o.products=r.products}]);
"use strict";angular.module("app.controllers").controller("productNewCtrl",["$scope","$stateParams","$store","$location","$invalidate","Product",function(e,t,a,o,c,p){var r=t.type;e.selected={type:{}},e.types=a.product_types,r&&(e.selected.type=a.get("product_types",{name:r})),e.save=function(){var t=new p;t.name=e.name,t.product_type_id=e.selected.type.id,t.$save().then(function(e){c.add("products"),o.path("/manage/product")})}}]);
"use strict";angular.module("app.controllers").controller("productViewCtrl",["$scope","$stateParams","$state","$store","$location","$invalidate",function(t,e,o,r,u,a){t.product=r.get("products",e.id),t["delete"]=function(){var e=confirm("Are you sure you want to delete this?");e&&t.product.$delete().then(function(){a.add(["products","product_types","units"]),u.path("/manage/product")})}}]);
"use strict";angular.module("app.controllers").controller("unitEditCtrl",["$scope","$stateParams","$store","$location","$invalidate","Unit",function(t,i,n,u,d,e){t.products=n.products,t.unit=_.clone(n.get("units",i.id)),t.selected={product:n.get("products",t.unit.product.id)},t.save=function(){t.unit.product_id=t.selected.product.id,e.update({id:t.unit.id},t.unit).$promise.then(function(i){d.add("units"),u.path("/manage/unit/"+t.unit.id)})}}]);
"use strict";angular.module("app.controllers").controller("unitManageCtrl",["$scope","$store",function(t,n){t.units=n.units}]);
"use strict";angular.module("app.controllers").controller("unitNewCtrl",["$scope","$stateParams","$store","$location","$invalidate","Unit",function(t,e,n,r,u,s){t.products=n.products;var o=e.product;t.selected={product:{}},o&&(t.selected.product=n.get("products",o)),t.save=function(){var e=new s;e.serial_number=t.serial_number,e.asset_number=t.asset_number,e.unit_number=t.unit_number,e.product_id=t.selected.product.id,e.notes=t.notes,e.$save().then(function(t){u.add("units"),r.path("/manage/unit")})}}]);
"use strict";angular.module("app.controllers").controller("unitViewCtrl",["$scope","$stateParams","$state","$store","$invalidate","$location",function(t,e,n,i,o,a){t.unit=i.get("units",e.id),t["delete"]=function(){var e=confirm("Are you sure you want to delete this?");e&&t.unit.$delete().then(function(){o.add(["units","products"]),a.path("/manage/unit")})}}]);
"use strict";angular.module("app.controllers").controller("userEditCtrl",["$scope","$stateParams","$state","$store","$location","$invalidate","User",function(e,r,s,u,o,t,a){e.dateOptions={showWeeks:!1,format:"d MMM yyyy"},e.openDob=function(){e.openDobDate=!e.openDobDate},e.roles=[{level:0,text:"Student"},{level:1,text:"Staff"},{level:2,text:"Manager"}],s.current.data.edit_profile?(e.user=u.user,e.profileMode=!0):(e.user=_.clone(u.get("users",r.id)),e.you=u.user),1==e.user.admin&&e.user.group&&!e.user.group._isTutor(u.user.id)&&o.path("/manage/user"),e.groups=u.groups,1===u.user.admin&&(e.groups=u.user.tutors_groups),e.selected={group:e.user.group?u.get("groups",e.user.group.id):{},role:_.find(e.roles,function(r){return r.level==e.user.admin})},e.save=function(){e.user.group_id=e.selected.group.id,e.user.admin=e.selected.role.level,a.update({id:e.user.id},e.user).$promise.then(function(r){t.add(["users","groups"]),o.path("/manage/user/"+e.user.id)},function(r){e.error=r.data.error})}}]);
"use strict";angular.module("app.controllers").controller("userEditNoteCtrl",["$scope","$stateParams","$store","$location","$invalidate","Note",function(e,t,o,n,s,a){e.user=_.clone(o.get("users",t.id)),e.note=o.get("notes",t.id2),e.note||n.path("/manage/user/"+e.user.id),e.save=function(){a.update({id:e.note.id},e.note).$promise.then(function(){s.add("notes"),n.path("/manage/user/"+e.user.id)})}}]);
"use strict";angular.module("app.controllers").controller("userManageCtrl",["$scope","$store","$location",function(r,e,o){r.users=e.users,r.staffFilter=function(r,o,s){return 2==e.user.admin||r.group&&r.group._isTutor(e.user.id)}}]);
"use strict";angular.module("app.controllers").controller("userNewCtrl",["$scope","$stateParams","$store","$location","$auth","$invalidate","User",function(e,o,r,s,t,a,n){e.dateOptions={showWeeks:!1,format:"d MMM yyyy"},e.openDob=function(){e.openDobDate=!e.openDobDate};var l=o["class"];e.roles=[{level:0,text:"Student"},{level:1,text:"Staff"},{level:2,text:"Manager"}],e.groups=r.groups,e.user=r.user,1===r.user.admin&&(e.groups=r.user.tutors_groups),e.selected={group:e.groups,role:e.roles[0]},l&&(e.selected.group=r.get("groups",{code:l})),e.save=function(){var o=new n;o.dob=e.dob,o.name=e.name,o.email=e.email,o.phone=e.phone,o.group_id=e.selected.group.id,o.password=e.password,o.id_number=e.id_number,o.admin=e.selected.role.level,o.$save().then(function(e){a.add("groups"),s.path("/manage/user")})["catch"](function(e){console.log("save err",e)})}}]);
"use strict";angular.module("app.controllers").controller("userNewNoteCtrl",["$scope","$stateParams","$store","$location","$invalidate","User","Note",function(e,t,n,o,s,r,a){e.content="",e.user=_.clone(n.get("users",t.id)),e.save=function(){var t=new a;t.content=e.content,t.user_id=e.user.id,t.$save().then(function(t){s.add("notes"),o.path("/manage/user/"+e.user.id)})["catch"](function(e){console.log("save err",e)})}}]);
"use strict";angular.module("app.controllers").controller("userViewCtrl",["$scope","$stateParams","$store","$invalidate","$location","Note","User",function(e,t,r,o,n,u,s){e.user=r.get("users",t.id),1==e.user.admin&&e.user.group&&!e.user.group._isTutor(r.user.id)&&n.path("/manage/user"),e.filterOutRevisions=function(t){var r=!1;return _.forEach(e.user.notes,function(e){t.id==e.revision_of&&(r=!0)}),r},e["delete"]=function(){var t=confirm("Are you sure you want to delete this?");t&&e.user.$delete().then(function(){o.add(["users","groups","bookings"]),n.path("/manage/user")})},e.deleteNote=function(t){confirm("Are you sure you want to delete that note?")&&u["delete"]({id:t.id}).$promise.then(function(){r.notes=_.reject(e.user.notes,function(e){return e.id==t.id})})}}]);
"use strict";angular.module("app.controllers").controller("userViewNoteCtrl",["$scope","$stateParams","$store","$invalidate","$location","Note",function(e,t,o,n,r,s){e.user=_.clone(o.get("users",t.id)),e.note=o.get("notes",t.id2),e.notes=o.notes,e.dateify=function(e){return new Date(e)},e.deleteNote=function(t){confirm("Are you sure you want to delete that note?")&&s["delete"]({id:t.id}).$promise.then(function(){e.user.notes=_.reject(e.user.notes,function(e){return e.id==t.id})})}}]);
"use strict";function explode(e){function t(){c.clearRect(0,0,n.width,n.height),s.forEach(function(e,t){e.radius+=e.accel,e.accel-=h.ringAccelShrink*h.scale,e.accel<h.ringMinAccel&&(e.accel=h.ringMinAccel),e.alpha-=h.ringFade,c.strokeStyle="rgba(0, 0, 0, "+e.alpha+")",c.lineWidth=h.ringWidth*h.scale,c.beginPath(),c.arc(e.x,e.y,e.radius,0,2*Math.PI,!1),c.stroke()}),o.forEach(function(e,t){if(e.radius*=e.shrink,!(e.radius<0)){var a=at.step(e.rotation,e.speed);e.x+=a.x,e.y+=a.y,e.speed*=e.accel,e.yVel+=e.gravity,e.y+=e.yVel,c.beginPath(),c.fillStyle=e.color,c.arc(e.x,e.y,e.radius,0,2*Math.PI,!1),c.fill()}})}var a=e.pageX,i=e.pageY,n=document.createElement("canvas"),c=n.getContext("2d"),l=window.devicePixelRatio,o=[],s=[],d=["#FF1461","#18FF92","#5A87FF","#FBF38C"],h={numParticles:30,scale:1,radiusMin:60,radiusMax:100,speedMin:8,speedMax:16,accel:.95,ringFade:.03,ringAccel:20,ringAccelShrink:.8,ringMinAccel:.6,ringWidth:1,gravity:0};document.body.appendChild(n);var u=600,p=600;n.style.position="absolute",n.style.left=a-u/2+"px",n.style.top=i-p/2+"px",n.style.pointerEvents="none",n.style.width=u+"px",n.style.height=p+"px",n.style.zIndex=9999,n.width=u*l,n.height=p*l;for(var y=0;++y<h.numParticles+1;)o.push({x:n.width/2,y:n.height/2,radius:r(h.radiusMin*h.scale,h.radiusMax*h.scale),color:d[parseInt(Math.random()*d.length)],rotation:r(0,360,!0),speed:r(h.speedMin*h.scale,h.speedMax*h.scale),yVel:0,gravity:h.gravity*h.scale,accel:h.accel,shrink:.875});s.push({x:n.width/2,y:n.height/2,radius:0,accel:h.ringAccel*h.scale,alpha:1}),function g(){requestAnimationFrame(g),t()}(),setTimeout(function(){document.body.removeChild(n)},1e3)}function r(e,t,a){return parseFloat((Math.random()*((e?e:1)-(t?t:0))+(t?t:0)).toFixed(a?a:0))}Mousetrap.bindGlobal(["up up down down left right left right b a"],function(){return window.konami=!0,!1}),$(document).on("click",function(e){window.konami&&e.clientX&&e.clientY&&explode(e)});var at={angle:function(e,t){return Math.atan2(t.y-e.y,t.x-e.x)/Math.PI*180},dist:function(e,t){return Math.sqrt((e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y))},step:function(e,t){return{x:t*Math.cos(e*Math.PI/180),y:t*Math.sin(e*Math.PI/180)}}};
"use strict";angular.module("app.directives").directive("alert",function(){return{restrict:"E",replace:!0,transclude:!0,templateUrl:"directives/alert/alert.html",scope:{type:"@",text:"@",icon:"@"}}});
"use strict";angular.module("app.directives").directive("breadcrumbs",["$state","$location","$stateParams",function(r,t,e){function c(c,a,u){c.state=r,c.current_url=t.path(),c.crumbs=[],function n(r){r.data.crumb_parent&&(c.crumbs.push(r.data.crumb_parent),n(r.data.crumb_parent))}(r.current),c.crumbs.reverse(),c.fix=function(r){return r.indexOf(":")!=-1?r.split("/").map(function(r){return":"!=r[0]?r:e[r.slice(1)]?e[r.slice(1)]:r}).join("/").split("?")[0]:r.split("?")[0]}}return{restrict:"E",replace:!1,transclude:!1,link:c,templateUrl:"directives/breadcrumbs/breadcrumbs.html",scope:{}}}]);
"use strict";angular.module("app.directives").directive("btn",["$state","$store","$auth",function(e,t,i){function r(e,t,i,r,l){e.small=void 0!==i.small,e.large=void 0!==i.large,e.spin=void 0!==i.spin,e.circle=void 0!==i.circle,e.type||(e.type="primary"),l(function(t){t.length&&(e.hasTranscluded=!0)})}return{restrict:"E",replace:!0,transclude:!0,link:r,templateUrl:"directives/btn/btn.html",scope:{icon:"@",type:"@",url:"@",disable:"="}}}]);
"use strict";angular.module("app.directives").directive("dateInput",["$rootScope",function(e){function t(e,t,n){e.dateOptions={showWeeks:!1,format:"d MMM yyyy"},e.open=!1,e.toggle=function(){e.open=!e.open},e.clear=function(){e.model=""}}return{restrict:"E",link:t,replace:!0,templateUrl:"directives/date-input/date-input.html",scope:{model:"=ngModel",change:"=ngChange"}}}]);
"use strict";angular.module("app.directives").directive("filter",["$rootScope",function(e){function t(e,t,i){window.onkeyup=function(e){70==e.which&&e.ctrlKey===!0&&t.find("input").focus()}}return{restrict:"E",replace:!0,link:t,templateUrl:"directives/filter/filter.html",scope:{model:"=",filtered:"="}}}]);
"use strict";angular.module("app.directives").directive("loader",["$rootScope",function(e){function r(r,t,l){r.loader=e.loader}return{restrict:"E",replace:!1,link:r,templateUrl:"directives/loader/loader.html"}}]);
"use strict";angular.module("app.directives").directive("pager",["$state","$store","$auth","$queryString",function(t,e,r,a){function n(t,e,r){function a(){t.pages=[],t.allpages=[],t.current=t.current?t.current:n?n:1;var e=2,r=2*e+1;t.totalpages=Math.ceil((t.filter?t.filtered.length:t.data.length)/t.getLimit());var a=t.getCurrent()-e>1?t.getCurrent()-e:1;a>t.totalpages-r+1&&(a=t.totalpages-r+1),a=a<=1?1:a;for(var u=a;u<=t.totalpages;u++)(u>t.getCurrent()-e&&u<t.getCurrent()+e||t.pages.length<r)&&t.pages.push(u);for(var l=1;l<=t.totalpages;l++)t.allpages.push(l)}var n=null;t.getLimit=function(){return t.filter?99:t.limit},t.$watch("data",a,!0),t.$watch("current",a),t.$watch("filter",a),t.$watch("limit",a),t.setCurrent=function(e){t.current=e,t.updateOld()},t.updateOld=function(){null!==t.current&&(n=t.current)},t.getCurrent=function(){return t.filter?1:t.current?t.current:n?n:1}}return{restrict:"E",replace:!0,link:n,templateUrl:"directives/pager/pager.html",scope:{current:"=",limit:"=",data:"=",filtered:"=",filter:"="}}}]);
"use strict";angular.module("app.directives").directive("pagination",["$state","$store","$auth","$queryString","$window",function(t,e,a,i,r){function l(t,e,a){function l(){t.pages=[],t.allpages=[];var e=2,a=2*e+1;t.last=Math.ceil(t.total/t.filter.limit);var i=t.filter.page-e>1?t.filter.page-e:1;i>t.last-a+1&&(i=t.last-a+1),i=i<=1?1:i;for(var r=i;r<t.last+1;r++)(r>t.filter.page-e&&r<t.filter.page+e||t.pages.length<a)&&t.pages.push(r);for(var l=1;l<=t.last;l++)t.allpages.push(l);t.current=t.filter.page,t.atStart=1!==t.filter.page,t.atEnd=t.filter.page+e<=t.total/t.filter.limit}t.$watch("total",l),t.$watch("filter",function(e){t.query="&"+i(_.omit(t.filter,["page"]))},!0),t["goto"]=function(){console.log("#/bookings?page="+t.current+t.query),r.location.href="#/bookings?page="+t.current+t.query}}return{restrict:"E",replace:!0,link:l,templateUrl:"directives/pagination/pagination.html",scope:{total:"=",filter:"="}}}]);
"use strict";angular.module("app.directives").directive("navLink",["$location","$state","$rootScope",function(r,a,n){function t(t,e,c){function u(a){function n(r){r.data&&r.data.crumb_parent&&(t.crumbs.push(r.data.crumb_parent),n(r.data.crumb_parent))}r.path()==t.url.replace("#","")?e.addClass("current"):e.removeClass("current"),t.crumbs=[],n(a),_.forEach(t.crumbs,function(r){t.url.replace("#","")==r.url&&e.addClass("current")})}n.$on("$stateChangeSuccess",function(r,a,n){u(a)}),u(a.current)}return{restrict:"A",replace:!1,transclude:!1,link:t,template:'<a href="{{ url }}" layout="row" align="center"><span>{{ navLink }}</span></a>',scope:{navLink:"@",url:"@"}}}]);
"use strict";angular.module("app.directives").directive("sidebar",["$store","$auth","$load","$rootScope",function(e,r,t,i){function s(i,s,u){i.auth=r,i.user=e.user,t.listen("user",function(e){i.user=e})}return{restrict:"E",replace:!0,transclude:!1,link:s,templateUrl:"directives/sidebar/sidebar.html",scope:{}}}]);
"use strict";angular.module("app.directives").directive("selectDark",function(){function e(e,i,r,t){i.addClass("ui-select-dark")}return{restrict:"A",require:"uiSelect",link:e}});
"use strict";angular.module("app.directives").directive("selectUnitOnClose",function(){function e(e,t,n,i){angular.element(i.searchInput).on("keyup",function(){var e=this.value;_.forEach(i.items,function(t){var n=t.unit_number;e==n&&i.select(t)})})}return{restrict:"A",require:"uiSelect",link:e}});
"use strict";angular.module("app.filters").filter("page",["$filter",function(t){return function(e,r,i,n){return!n||n&&e.length<=n?e:t("limitTo")(e,i,(r-1)*i)}}]);
"use strict";angular.module("app.resources").factory("Booking",["$resource",function(o){var r="/api/booking/:id",e={id:"@id"},i={update:{method:"PUT"}};return o(r,e,i)}]);
"use strict";angular.module("app.resources").factory("Group_Type",["$resource",function(r){var e="/api/group_type/:id",u={id:"@id"},o={update:{method:"PUT"}};return r(e,u,o)}]);
"use strict";angular.module("app.resources").factory("Group",["$resource",function(r){var u="/api/group/:id",e={id:"@id"},o={update:{method:"PUT"}};return r(u,e,o)}]);
"use strict";angular.module("app.resources").factory("Note",["$resource",function(e){var r="/api/note/:id",t={id:"@id"},o={update:{method:"PUT"}};return e(r,t,o)}]);
"use strict";angular.module("app.resources").factory("Product_Type",["$resource",function(r){var e="/api/product_type/:id",t={id:"@id"},u={update:{method:"PUT"}};return r(e,t,u)}]);
"use strict";angular.module("app.resources").factory("Product",["$resource",function(r){var u="/api/product/:id",e={id:"@id"},t={update:{method:"PUT"}};return r(u,e,t)}]);
"use strict";angular.module("app.resources").factory("Unit",["$resource",function(r){var e="/api/unit/:id",t={id:"@id"},u={update:{method:"PUT"}};return r(e,t,u)}]);
"use strict";angular.module("app.resources").factory("User",["$resource",function(r){var e="/api/user/:id",t={id:"@id"},u={update:{method:"PUT"},getWithToken:{method:"GET",url:"/api/auth",params:{"with":"tutors_groups.type"}}};return r(e,t,u)}]);
"use strict";angular.module("app.services").factory("$invalidate",["$rootScope","$auth","$store","$interval","$load",function(s,e,r,a,t){var o={invalidated:[]};return o.add=function(s){s instanceof Array?_.forEach(s,function(s){o.invalidated.indexOf(s)===-1&&o.invalidated.push(s)}):o.invalidated.push(s)},o.all=function(){e.getPayload()&&e.getPayload().admin?o.add(["user","users","groups","group_types","product_types","products","units","notes"]):o.add(["user","groups","products","units"])},o.except=function(s){o.all(),s.forEach(function(s){o.invalidated=_.reject(o.invalidated,function(e){return e==s})})},o.load=function(){var s=[];return _.forEach(o.invalidated,function(e){var a;switch(e){case"user":a=t.user(),r.user=a,s.push(a.$promise);break;case"users":a=t.users(),r.users=a,s.push(a.$promise);break;case"units":a=t.units(),r.units=a,s.push(a.$promise);break;case"groups":a=t.groups(),r.groups=a,s.push(a.$promise);break;case"products":a=t.products(),r.products=a,s.push(a.$promise);break;case"bookings":a=t.bookings(),r.bookings=a,s.push(a.$promise);break;case"group_types":a=t.group_types(),r.group_types=a,s.push(a.$promise);break;case"product_types":a=t.product_types(),r.product_types=a,s.push(a.$promise);break;case"notes":a=t.notes(),r.notes=a,s.push(a.$promise)}}),o.invalidated=[],s},o.add(["groups"]),e.isAuthenticated()&&o.all(),a(function(){o.all()},3e5),o}]);
"use strict";angular.module("app.services").factory("$load",["$store","$prepare","$auth","User","Group","Group_Type","Product_Type","Product","Unit","Booking","Note",function(t,r,n,e,o,u,i,s,p,c,a){var y={},h=[];return y.user=function(){var t=e.getWithToken();return t.$promise.then(r.user).then(y.notify("user")),t},y.users=function(){var t=e.query({"with":"tutors_groups.type"});return t.$promise.then(r.users).then(y.notify("users")),t},y.group_types=function(){var t=u.query();return t.$promise.then(r.group_types).then(y.notify("group_types")),t},y.groups=function(){var t={"with":"allowed_products.type"};n.getPayload()&&n.getPayload().admin&&(t["with"]="allowed_products|tutors");var e=o.query(t);return e.$promise.then(r.groups).then(y.notify("groups")),e},y.product_types=function(){var t=i.query();return t.$promise.then(r.product_types).then(y.notify("product_types")),t},y.products=function(){var t=s.query({"with":"groups_allowed"});return t.$promise.then(r.products).then(y.notify("products")),t},y.units=function(){var t=p.query();return t.$promise.then(r.units).then(y.notify("units")),t},y.booking=function(t){var n=c.get({id:t,"with":"products"});return n.$promise.then(r.booking).then(y.notify("bookings")),n},y.bookings=function(t,n){var e=c.query({limit:t,page:n,"with":"products"});return e.$promise.then(r.bookings).then(y.notify("bookings")),e},y.notes=function(){var t=a.query({});return t.$promise.then(r.notes).then(y.notify("notes")),t},y.listen=function(t,r){h.push({name:t,callback:r})},y.notify=function(t){return function(r){return y.trigger(t,r)}},y.trigger=function(t,r){_.forEach(h,function(n){n.name==t&&n.callback(r)})},y}]);
"use strict";angular.module("app.services").factory("$merge",["$store",function(o){var n={};return n.bookings=function(n){n.forEach(function(n){_.find(o.bookings,{id:n.id})||o.bookings.push(n)}),o.bookings.sort(function(o,n){return o.id-n.id})},n}]);
"use strict";angular.module("app.services").factory("$message",function(){var t={};return t.data={},t.set=function(a,e){return t.data[a]=e},t.get=function(a){return t.data[a]},t.flash=function(a){var e=t.data[a];return e?(delete t.data[a],e):void 0},t});
"use strict";angular.module("app.services").factory("$prepare",["$store",function(e){var t={},r=!0,n=!0;return t.users=function(e){return _.forEach(e,t.user),e},t.user=function(t){2===t.admin&&(t._role="Manager"),1===t.admin&&(t._role="Staff"),0===t.admin&&(t._role="Student");var u=moment.duration(moment().diff(moment(t.dob)));return t._age=u.asYears().toFixed(0),t.dob&&(t.dob=new Date(t.dob)),Object.defineProperty(t,"group",{enumerable:r,configurable:n,get:function(){return _.find(e.groups,{id:t.group_id})}}),Object.defineProperty(t,"bookings",{get:function(){return _.filter(e.bookings,{user_id:t.id})}}),Object.defineProperty(t,"notes",{get:function(){return _.filter(e.notes,{user_id:t.id})}}),t},t.groups=function(t){return _.forEach(t,function(t){Object.defineProperty(t,"type",{enumerable:r,configurable:n,get:function(){return _.find(e.group_types,{id:t.group_type_id})}}),Object.defineProperty(t,"users",{get:function(){return _.filter(e.users,{group_id:t.id})}}),t._isTutor=function(r){return!!_.find(t.tutors,{id:e.user.id})}}),t},t.group_types=function(t){return _.forEach(t,function(t){Object.defineProperty(t,"groups",{get:function(){return _.filter(e.groups,{group_type_id:t.id})}})}),t},t.products=function(t){return _.forEach(t,function(t){t._quantity="",Object.defineProperty(t,"type",{enumerable:r,configurable:n,get:function(){return _.find(e.product_types,{id:t.product_type_id})}}),Object.defineProperty(t,"units",{get:function(){return _.filter(e.units,{product_id:t.id})}})}),t},t.product_types=function(t){return _.forEach(t,function(t){Object.defineProperty(t,"products",{get:function(){return _.filter(e.products,{product_type_id:t.id})}})}),t},t.units=function(t){return _.forEach(t,function(t){Object.defineProperty(t,"product",{enumerable:r,configurable:n,get:function(){return _.find(e.products,{id:t.product_id})}})}),t},t.booking=function(t){function u(e){var t=(e.replace(" ","T").concat(".000Z"),moment(e).add(moment().utcOffset(),"minutes").format("x"));return new Date(parseInt(t))}return t.created_at&&(t.created_at=u(t.created_at)),t.due_at&&(t.due_at=u(t.due_at)),t.pickup_at&&(t.pickup_at=u(t.pickup_at)),t.taken_at&&(t.taken_at=u(t.taken_at)),t.closed_at&&(t.closed_at=u(t.closed_at)),t.cancelled_at&&(t.cancelled_at=u(t.cancelled_at)),t._priority=0,t.taken_at||(t._priority=1,t._status="Booked"),t.taken_at&&!t.returned_at&&(t._priority=2,t._status="Issued",t.due_at.valueOf()<(new Date).valueOf()&&(t._overdue=!0)),t.closed_at&&(t._priority=3,t._status="Closed"),t.cancelled_at&&(t._priority=4,t._status="Cancelled"),_.forEach(t.products,function(e){e.pivot.returned_at&&(e.pivot.returned_at=new Date(e.pivot.returned_at))}),t.user||Object.defineProperty(t,"user",{enumerable:r,configurable:n,get:function(){return _.find(e.users,{id:t.user_id})}}),Object.defineProperty(t,"created_by",{get:function(){return _.find(e.users,{id:t.created_by_id})}}),Object.defineProperty(t,"issued_by",{get:function(){return _.find(e.users,{id:t.issued_by_id})}}),Object.defineProperty(t,"closed_by",{get:function(){return _.find(e.users,{id:t.closed_by_id})}}),Object.defineProperty(t,"_products",{get:function(){var r=[];return _.forEach(t.products,function(t){r.push(_.find(e.products,{id:t.id}))}),r}}),t},t.bookings=function(e){return _.forEach(e,t.booking),e},t.notes=function(t){return _.forEach(t,function(t){Object.defineProperty(t,"history",{enumerable:r,configurable:n,get:function(){function r(t,n){if(n.revision_of){var u=_.find(e.notes,{id:n.revision_of});return t.push(u),r(t,u)}return t}return _.sortBy(r([],t),function(e){return-new Date(e.created_at).valueOf()})}}),Object.defineProperty(t,"user",{get:function(){return _.find(e.users,{id:t.user_id})}}),Object.defineProperty(t,"writer",{get:function(){return _.find(e.users,{id:t.writer_id})}})}),t},t}]);
"use strict";angular.module("app.services").factory("$pretend",["$q","$timeout",function(t,n){var r={wait:function(r){return t(function(t,u){n(function(){t()},r)})}};return r}]);
"use strict";angular.module("app.services").factory("$queryString",["$store",function(r){var e=function(r,e){var n="";for(var t in r){var a=r[t];a!==!1&&""!==a&&void 0!==a&&null!==a&&("page"===t&&1===a||(a===!0&&(a="true"),a instanceof Date&&(a=a.valueOf()),n+=t+"="+a+"&"))}return n.length?(e?"?":"")+n.substring(0,n.length-1):""};return e}]);
"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o};angular.module("app.services").factory("$store",["Booking",function(o){var n={user:{},units:[],users:[],notes:[],groups:[],booking:{},products:[],bookings:[],group_types:[],product_types:[]};return window.store=n,n.setBooking=function(o){localStorage.booking=JSON.stringify(o),n.booking=o},n.resetBooking=function(){localStorage.removeItem("booking"),n.booking={}},n.clear=function(o){o instanceof Array?_.forEach(o,function(o){n[o]={}}):n[o]={}},n.get=function(o,t){var e=_.find(n[o],"object"==("undefined"==typeof t?"undefined":_typeof(t))&&null!==t?t:{id:parseInt(t)});return e},localStorage.booking&&(n.booking=JSON.parse(localStorage.booking),n.booking.pickup_at&&(n.booking.pickup_at=new Date(n.booking.pickup_at)),n.booking.due_at&&(n.booking.due_at=new Date(n.booking.due_at))),n}]);
"use strict";angular.module("app.services").factory("$title",["$rootScope",function(t){var e=function(e){t.pageTitle=e+" - Booking"};return e}]);
"use strict";angular.module("app.views").run(["$templateCache",function(e){e.put("components/home/home.html",'<header class="page-header" layout="row" align="center" justify="between"><h1>Welcome, {{ user.name }}</h1><btn type="primary" url="#/home/edit_profile" icon="pencil">Edit Profile</btn></header><div class="page-content"><div layout="col"><div layout="row" align="start sm-stretch"><section ratio="1"><h2>Your Current Bookings</h2><ul><li ng-repeat="booking in bookings" ng-show="booking._priority < 3"><a href="#/booking/{{ booking.id }}">{{ booking.created_at | date }}</a></li></ul></section></div><div layout="row sm-col" align="start sm-stretch"><section ratio="1"><h2>Your Recent Bookings</h2><ul><li ng-repeat="booking in bookings"><a href="#/booking/{{ booking.id }}">{{ booking.created_at | date }}</a></li></ul></section><section ratio="1"><h2>Your Previous Bookings</h2><ul><li ng-repeat="booking in bookings" ng-show="booking._priority > 2"><a href="#/booking/{{ booking.id }}">{{ booking.created_at | date }}</a></li></ul></section></div></div></div>'),e.put("directives/alert/alert.html",'<div class="alert alert-{{ type }}"><p layout="row" align="center" justify="between"><span><i class="fa fa-fw fa-{{ icon }}" ng-if="icon"></i><span ng-bind-html="text"></span></span><ng-transclude></ng-transclude></p></div>'),e.put("directives/breadcrumbs/breadcrumbs.html",'<div class="breadcrumbs"><ul layout="row"><li ng-repeat="crumb in crumbs" layout="row"><a href="#{{ fix(crumb.url) }}"> {{ crumb.data.title }}</a></li><li><a href="#{{ current_url }}">{{ state.current.data.title }}</a></li></ul></div>'),e.put("directives/btn/btn.html",'<span><button type="button" ng-show="!url" class="btn btn-{{ type }}" ng-class="{\'btn-sm\': small,\'btn-large\': large,\'btn-circle\': circle,\'btn-icon\': icon && hasTranscluded}" ng-disabled="disable"><i class="fa fa-fw fa-{{ icon }}" ng-class="{\'fa-spin\': spin}" ng-show="icon"></i><ng-transclude></ng-transclude></button><a href="{{ url }}" ng-show="url" class="btn btn-{{ type }}" ng-class="{\'btn-sm\': small,\'btn-large\': large,\'btn-circle\': circle,\'btn-icon\': icon && hasTranscluded}" ng-disabled="disable"><i class="fa fa-fw fa-{{ icon }}" ng-class="{\'fa-spin\': spin}" ng-show="icon"></i><ng-transclude></ng-transclude></a></span>'),e.put("directives/date-input/date-input.html",'<div class="date-input"><input type="text" ng-model="model" ng-change="change()" class="form-control" uib-datepicker-popup="{{ dateOptions.format }}" is-open="open" datepicker-options="dateOptions" ng-click="toggle()"><i class="fa fa-calendar"></i><button class="close" ng-click="clear()" ng-show="model"><i class="fa fa-times-circle"></i></button></div>'),e.put("directives/filter/filter.html",'<div class="filter" ng-class="{ active: model.length, nomatch: model.length && !filtered.length }"><input type="search" ng-model="model" class="form-control" placeholder="filter..."><i class="fa fa-search"></i><div class="output"><span ng-show="model.length && filtered.length">{{ filtered.length }}</span><span ng-show="model.length && !filtered.length">No matches</span></div></div>'),e.put("directives/loader/loader.html",'<div class="loader" ng-class="{\'loader-show\': loader}"><div class="icon"><i class="fa fa-circle-o-notch fa-spin fa-3x fa-fw"></i></div></div>'),e.put("directives/pager/pager.html",'<nav class="pagination-container" layout="row" justify="center"><ul class="pagination"><li class="page-item" ng-class="{disabled: getCurrent() == 1}"><span class="page-link" ng-click="setCurrent(1)">First</span></li><li class="page-item" ng-class="{disabled: getCurrent() == 1}"><span class="page-link" ng-click="setCurrent(getCurrent() - 1)">&laquo;</span></li><li class="page-item" ng-repeat="page in pages" ng-class="{active: getCurrent() == page}"><span class="page-link" ng-click="setCurrent(page)">{{ page }}</span></li><li class="page-item" ng-class="{disabled: getCurrent() == totalpages}"><span class="page-link" ng-click="setCurrent(getCurrent() + 1)">&raquo;</span></li><li class="page-item" ng-class="{disabled: getCurrent() == totalpages}"><span class="page-link" ng-click="setCurrent(totalpages)">Last ({{ totalpages }})</span></li></ul><select ng-model="current" ng-change="updateOld()" ng-options="(\'page: \' + num) for num in allpages" class="form-control page-picker"></select></nav>'),e.put("directives/pagination/pagination.html",'<nav class="pagination-container" layout="row" justify="center"><ul class="pagination"><li class="page-item" ng-class="{disabled: !atStart}"><a href="#/bookings?page=1{{ query }}" class="page-link">First</a></li><li class="page-item" ng-class="{disabled: filter.page == 1}"><a href="#/bookings?page={{ filter.page - 1 }}{{ query }}" class="page-link">&laquo;</a></li><li class="page-item" ng-repeat="page in pages" ng-class="{active: filter.page == page}"><a href="#/bookings?page={{ page }}{{ query }}" class="page-link">{{ page }}</a></li><li class="page-item" ng-class="{disabled: filter.page == last}"><a href="#/bookings?page={{ filter.page + 1 }}{{ query }}" class="page-link">&raquo;</a></li><li class="page-item" ng-class="{disabled: filter.page == last}"><a href="#/bookings?page={{ last }}{{ query }}" class="page-link">Last ({{ last }})</a></li></ul><select ng-model="current" ng-change="goto()" ng-options="(\'page: \' + num) for num in allpages" class="form-control page-picker"></select></nav>'),e.put("directives/sidebar/sidebar.html",'<div class="sidebar" layout="col md-row" align="md-stretch" justify="md-between"><header layout="row" justify="center" align="center"><!-- <img src="/images/logo2.svg" alt="" class="logo" height="50"> --><div class="logo"><img src="/images/Yoobee_Design_School_Logo_EPS.png" height="50" alt=""><span class="caption">Equipment Booking</span></div><!-- <h1>Booking System</h1> --></header><nav><!-- guest --><ul layout="col md-row" align="md-stretch" ng-if="!auth.isAuthenticated()"><li nav-link="Login" url="#/login"></li><li nav-link="Register" url="#/register"></li></ul><!-- student --><ul layout="col md-row" align="md-stretch" ng-if="auth.isAuthenticated() && user.admin == 0"><li nav-link="Home" url="#/"></li><li nav-link="Make booking" url="#/book"></li><li nav-link="Modify booking" url="#/book/edit"></li><li nav-link="Logout" url="#/logout"></li></ul><!-- staff --><ul layout="col md-row" align="md-stretch" ng-if="auth.isAuthenticated() && user.admin == 1"><li nav-link="Home" url="#/"></li><li nav-link="Make booking" url="#/book"></li><li nav-link="View bookings" url="#/bookings"></li><li nav-link="Manage Data" url="#/manage"></li><li nav-link="Logout" url="#/logout"></li></ul><!-- manager --><ul layout="col md-row" align="md-stretch" ng-if="auth.isAuthenticated() && user.admin == 2"><li nav-link="Home" url="#/"></li><li nav-link="Make booking" url="#/book"></li><li nav-link="View bookings" url="#/bookings"></li><li nav-link="Manage Data" url="#/manage"></li><li nav-link="Logout" url="#/logout"></li></ul></nav></div>'),e.put("components/booking/edit/edit.html",'<header class="page-header" layout="row" align="center" justify="between"><h1>Edit Booking</h1><btn icon="floppy-o" ng-click="save()">Save changes</btn></header><breadcrumbs></breadcrumbs><div class="page-dates"><div layout="row sm-col" class="space-row"><div ratio="1"><label for="pickup_at">Pickup date</label><input type="text" id="pickup_at" ng-model="booking.pickup_at" ng-change="createBooking()" class="form-control form-control-sm" uib-datepicker-popup="{{ dateOptions.format }}" is-open="openPickupDate" datepicker-options="dateOptions" ng-click="openPickup()"></div><div ratio="1"><label for="due_at">Return date</label><input type="text" id="due_at" ng-model="booking.due_at" ng-change="createBooking()" class="form-control form-control-sm" uib-datepicker-popup="{{ dateOptions.format }}" is-open="openDueDate" datepicker-options="dateOptions" ng-click="openDue()"></div></div></div><filter model="filter" filtered="filtered"></filter><div class="page-content"><table class="table table-hover booking-table table-filtered" ng-show="filtered.length"><thead><tr><th class="booking-heading-product">Product</th><th class="booking-heading-type sm-hide">Type</th><th class="booking-heading-quantity">Available</th><th class="booking-heading-quantity">Quantity</th></tr></thead><tr ng-repeat="product in products | filter: filter as filtered"><td>{{ product.name }}</td><td class="sm-hide">{{ product.type.name }}</td><td>{{ max(product) }}</td><td><input type="number" ng-model="product._quantity" class="form-control booking-quantity-input form-control-sm" max="{{ max(product) }}" ng-keyup="checkAgainstMax(product)" min="0" ng-change="createBooking()"></td></tr></table></div>'),e.put("components/booking/confirm/confirm.html",'<header class="page-header" layout="row" align="center" justify="between"><h1>Confirm booking</h1></header><div class="page-content" ng-show="user.can_book"><p>Does this look right?</p><p>If not, you can <a href="#/book">go back</a> and modify it first.</p><table class="table data-table"><tr><td class="row-property">User</td><td class="row-value">{{ booking._user.name }}</td></tr><tr><td class="row-property">Pick Up</td><td class="row-value"><span ng-show="booking.pickup_at">{{ booking.pickup_at | date }}</span><alert type="danger" text="You don\'t have a pickup date" icon="exclamation-circle" ng-show="!booking.pickup_at"></alert></td></tr><tr><td class="row-property">Due</td><td class="row-value"><span ng-show="booking.due_at">{{ booking.due_at | date }}</span><alert type="danger" text="You don\'t have a return date" icon="exclamation-circle" ng-show="!booking.due_at"></alert></td></tr><tr><td class="row-property">Items</td><td class="row-value"><ul ng-show="booking.products.length"><li ng-repeat="item in booking.products" ng-class="{\'not-allowed\': !allowed(item.id)}"><i class="fa fa-exclamation-triangle" ng-show="!allowed(item.id)"></i>&nbsp;{{ product(item.id).name }}<b ng-hide="product(item.id).limitless"> x{{ item.quantity }}</b></li></ul><alert type="danger" text="You aren\'t booking any products" icon="exclamation-circle" ng-show="!booking.products.length"></alert></td></tr></table><btn type="success" large icon="check" ng-click="confirm()" disable="disableSubmit()">Yes</btn><br><br><alert type="danger" icon="exclamation-triangle" ng-show="!overallAllowed" text="Some of your chosen items are unavailable during your chosen time period"></alert></div><div class="page-content" ng-show="!user.can_book"><alert type="danger" icon="exclamation-triangle" text="You are not allowed to make bookings"></alert><p>Reason: <strong>{{ user.can_book_reason }}</strong></p><p>Please talk to your tutor to resolve this issue.</p></div>'),e.put("components/booking/issue/issue.html",'<header class="page-header" layout="row" align="center" justify="between"><h1>Issue equipment</h1><btn icon="check" ng-click="issue()" disable="errors.length">Done</btn></header><breadcrumbs></breadcrumbs><div class="page-dates" ng-show="!errors.length"><div layout="row sm-col" class="space-row"><div ratio="1"><label for="pickup_at">Pickup date</label><input type="text" id="pickup_at" ng-model="booking.pickup_at" ng-change="createBooking()" class="form-control form-control-sm" uib-datepicker-popup="{{ dateOptions.format }}" is-open="openPickupDate" datepicker-options="dateOptions" ng-click="openPickup()"></div><div ratio="1"><label for="due_at">Return date</label><input type="text" id="due_at" ng-model="booking.due_at" ng-change="createBooking()" class="form-control form-control-sm" uib-datepicker-popup="{{ dateOptions.format }}" is-open="openDueDate" datepicker-options="dateOptions" ng-click="openDue()"></div></div></div><filter model="filter" filtered="filtered" ng-show="!errors.length"></filter><div class="page-content"><div class="alert alert-danger" ng-show="errors.length"><p ng-repeat="error in errors">Error: <b>{{ error.message }}</b></p></div><!-- <alert ng-show="error" type="danger" icon="exclamation-triangle" text="{{ error }}"></alert> --><table class="table table-hover booking-table table-filtered" ng-show="filtered.length && errors.length"><thead><tr><th class="booking-heading-product">Product</th><th class="table-col-select-medium">Unit</th></tr></thead><tr ng-repeat="product in booking._products | filter: filter as filtered  track by $index"><td>{{ product.name }}</td><td><ui-select select-unit-on-close ng-model="booking.products[$index].unit" id="group"><ui-select-match allow-clear="false" placeholder="​"><span ng-bind="$select.selected.unit_number" class="setheight"></span></ui-select-match><ui-select-choices repeat="unit in (product.units | filter: isntSelected(booking.products[$index]) | filter: $select.search)"><div ng-bind-html="unit.unit_number | highlight: $select.search"></div></ui-select-choices></ui-select></td></tr></table></div>'),e.put("components/booking/make/make.html",'<header class="page-header" layout="row" align="center" justify="between"><h1>Book equipment</h1><div class="btn-group" ng-show="user.can_book"><button class="btn btn-primary btn-icon" ng-click="book()"><i class="fa fa-book"></i>Make Booking</button><button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="sr-only">Toggle Dropdown</span></button><div class="dropdown-menu dropdown-menu-right"><span class="dropdown-item btn-icon" ng-click="reset()"><i class="fa fa-undo"></i>Reset</span></div></div></header><div class="page-dates" layout="col" ng-show="user.can_book"><div layout="row sm-col" class="space-row"><div ratio="1"><label for="pickup_at">Pickup date</label><input type="text" id="pickup_at" ng-model="booking.pickup_at" ng-change="createBooking()" class="form-control form-control-sm" uib-datepicker-popup="{{ dateOptions.format }}" is-open="openPickupDate" datepicker-options="dateOptions" ng-click="openPickup()"></div><div ratio="1"><label for="due_at">Return date</label><input type="text" id="due_at" ng-model="booking.due_at" ng-change="createBooking()" class="form-control form-control-sm" uib-datepicker-popup="{{ dateOptions.format }}" is-open="openDueDate" datepicker-options="dateOptions" ng-click="openDue()"></div></div><div class="page-user" ng-show="user.admin"><label for="user_id">User</label><ui-select select-unit-on-close ng-model="booking._user" id="user_id"><ui-select-match allow-clear="false" placeholder="​"><span ng-bind="$select.selected.name" class="setheight"></span></ui-select-match><ui-select-choices repeat="user in (users | filter: $select.search)"><div ng-bind-html="user.name | highlight: $select.search"></div><small ng-bind-html="user.group.code | highlight: $select.search"></small></ui-select-choices></ui-select></div></div><filter model="filter" filtered="filtered" ng-show="user.can_book"></filter><div class="page-content" ng-show="user.can_book"><table class="table table-hover booking-table table-filtered" ng-show="filtered.length"><thead><tr><th class="booking-heading-product">Product</th><th class="booking-heading-type sm-hide">Type</th><th class="booking-heading-quantity">Available</th><th class="booking-heading-quantity">Quantity</th></tr></thead><tr ng-repeat="product in products | filter: filter as filtered"><td>{{ product.name }}</td><td class="sm-hide">{{ product.type.name }}</td><td>{{ product.limitless ? \'N/A\' : max(product) }}</td><td><div layout="row" justify="center"><input type="number" ng-model="product._quantity" class="form-control booking-quantity-input form-control-sm" max="{{ max(product) }}" ng-keyup="checkAgainstMax(product)" min="0" ng-change="createBooking()" ng-show="!product.limitless"><input type="checkbox" ng-model="product._quantity" ng-true-value="1" ng-false-value="0" ng-show="product.limitless"></div></td></tr></table></div><div class="page-content" ng-show="!user.can_book"><alert type="danger" icon="exclamation-triangle" text="You are not allowed to make bookings"></alert><p>Reason: <strong>{{ user.can_book_reason }}</strong></p><p>Please talk to your tutor to resolve this issue.</p></div>'),e.put("components/booking/manage/manage.html",'<header class="page-header" layout="row" align="center" justify="between"><h1>All Bookings</h1><div class="btn-group"><button class="btn btn-primary btn-icon" ng-click="advFilter.toggleOpen()"><i class="fa fa-filter"></i>Filter</button><button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="sr-only">Toggle Dropdown</span></button><div class="dropdown-menu dropdown-menu-right"><span class="dropdown-item btn-icon" ng-click="advFilter.clear()"><i class="fa fa-undo"></i>Reset</span></div></div></header><breadcrumbs></breadcrumbs><div class="page-advanced-filter" ng-show="advFilter.open" ng-class="{\'filter-open\': advFilter.open}"><div ng-show="advFilter.open" class="filter-drawer"><div layout="row" align="center" justify="between" class="pad-down"><h2>Filter</h2><btn type="success" icon="check" ng-click="advFilter.apply()" ng-show="advFilter.open">Apply</btn></div><div layout="row sm-col"><div class="filter-col" layout="col" ratio="1"><section layout="col"><div class="group-heading first">Date Ranges</div><div class="item"><label>After</label><date-input ng-model="advFilter.props.after"></date-input></div><div class="item"><label>Before</label><date-input ng-model="advFilter.props.before"></date-input></div></section><section layout="col"><div class="group-heading">User</div><div class="item has-select-clearer"><ui-select select-unit-on-close select-dark ng-model="advFilter.props.user"><ui-select-match allow-clear="false" placeholder="​"><span ng-bind="$select.selected.name" class="setheight"></span></ui-select-match><ui-select-choices repeat="user in (users | filter: $select.search)"><div ng-bind-html="user.name | highlight: $select.search"></div><small ng-bind-html="user.group.code | highlight: $select.search"></small></ui-select-choices></ui-select><button class="close" ng-click="advFilter.clearUser()" ng-show="advFilter.props.user"><i class="fa fa-times-circle"></i></button></div></section></div><div class="filter-col" layout="col" ratio="1"><section layout="col"><div class="group-heading">Types</div><div class="item"><label class="checkbox"><input type="checkbox" ng-model="advFilter.props.overdue"> Show overdue</label></div><div class="item"><label class="checkbox"><input type="checkbox" ng-model="advFilter.props.closed"> Show closed</label></div><div class="item"><label class="checkbox"><input type="checkbox" ng-model="advFilter.props.issued"> Show issued</label></div><div class="item"><label class="checkbox"><input type="checkbox" ng-model="advFilter.props.booked"> Show booked</label></div></section><section layout="col"><div class="group-heading">Per Page</div><div class="item"><input type="number" ng-model="advFilter.props.limit" class="form-control"></div></section></div></div></div></div><div class="page-content" ratio="1"><pager current="page" limit="advFilter.props.limit" data="bookings" filtered="filtered" filter="filter" ng-show="!filter && bookings.length >= 30"></pager><div ng-show="bookings.length"><table class="table table-hover table-filtered"><thead><tr><th>User</th><th width="20%">Class</th><th width="30%">Status</th><th width="10%" class="table-col-controls"></th></tr></thead><tbody><tr ng-repeat="booking in bookings | page: page : advFilter.props.limit : 30 as filtered" class="filterable-row"><td class="filterable-cell">{{ booking.user.name }}</td><td class="filterable-cell">{{ booking.user.group.code }}</td><td>{{ booking._status }}<span ng-show="booking._overdue && booking._priority == 2"> (overdue)</span><span ng-show="booking._priority == 3"> ({{ booking.closed_at | date }})</span></td><td class="button-row"><btn url="#/booking/{{ booking.id }}" type="info" icon="arrow-right" small>View</btn></td></tr></tbody></table></div><div ng-show="!bookings.length"><alert type="danger" icon="exclamation-triangle" text="No bookings match your filter critera"></alert></div></div>'),e.put("components/booking/return/return.html",'<header class="page-header" layout="row" align="center" justify="between"><h1>Return equipment</h1><btn icon="check" ng-click="close()" disable="errors.length">Done</btn></header><breadcrumbs></breadcrumbs><filter model="filter" filtered="filtered"></filter><div class="page-content"><div class="alert alert-danger" ng-show="errors.length"><p ng-repeat="error in errors">Error: <b>{{ error.message }}</b></p></div><table class="table table-hover booking-table table-filtered" ng-show="filtered.length"><thead><tr><th class="table-col-checkbox"></th><th class="booking-heading-product">Product</th><th class="table-col-select-medium">Unit</th><th class="table-col-medium-input">Notes</th></tr></thead><tr ng-repeat="product in booking.products | filter: filter as filtered  track by $index"><td><input type="checkbox" ng-model="product.returned" id="returned-{{ $index }}" ng-disabled="product.locked"></td><td><label for="returned-{{ $index }}">{{ product.name }}</label></td><td><label for="returned-{{ $index }}">{{ unit(product.pivot.unit_id).unit_number }}</label></td><td><input type="text" ng-model="product.pivot.notes" class="form-control"></td></tr></table></div>'),e.put("components/booking/success/success.html",'<header class="page-header" layout="row" align="center" justify="between"><h1>Booking made!</h1></header><div class="page-content" ratio="1"><h2>Woo!</h2><p>You just made a booking!</p></div>'),e.put("components/booking/view/view.html",'<header class="page-header" layout="row" align="center" justify="between"><h1>Booking: {{ booking.pickup_at | date }}</h1><btn url="#/booking/{{ booking.id }}/return" icon="arrow-left" ng-show="booking._priority == 2">Return</btn><div class="btn-group" ng-show="booking._priority == 1 && user.admin"><a href="#/booking/{{ booking.id }}/issue" class="btn btn-primary btn-icon"><i class="fa fa-arrow-right"></i>Issue</a><button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="sr-only">Toggle Dropdown</span></button><div class="dropdown-menu dropdown-menu-right"><a href="#/booking/{{ booking.id }}/edit" class="dropdown-item btn-icon"><i class="fa fa-pencil"></i>Edit</a><span class="dropdown-item btn-icon" ng-click="delete()"><i class="fa fa-trash"></i>Delete</span></div></div></header><breadcrumbs ng-show="user.admin"></breadcrumbs><div class="page-content" ratio="1"><div class="alert alert-danger" ng-show="errors.length"><p ng-repeat="error in errors">Error: <b>{{ error.message }}</b></p></div><div ng-show="!errors.length"><table class="table data-table"><tr><td class="row-property">User</td><td class="row-value">{{ booking.user.name }}</td></tr><tr><td class="row-property">Status</td><td class="row-value">{{ booking._status }}</td></tr><tr><td class="row-property">Created</td><td class="row-value">{{ booking.created_at | date }}</td></tr><!-- <tr><td class="row-property">Created by</td><td class="row-value">{{ booking.created_by.name }}</td></tr><tr><td class="row-property">Issued by</td><td class="row-value">{{ booking.issued_by.name }}</td></tr><tr><td class="row-property">Closed by</td><td class="row-value">{{ booking.closed_by.name }}</td></tr> --></table><div class="date-row" layout="row sm-col md-col"><div class="pickup" ratio="1" layout="row md-col sm-col"><div layout="row" justify="center" align="center" class="icon"><i class="fa fa-upload"></i></div><div layout="col"><div layout="row"><h2>Pickup</h2><p>{{ booking.pickup_at | date }}</p></div><div layout="row"><h2>Issued</h2><p ng-show="booking.taken_at">{{ booking.taken_at | date }}</p><p ng-show="!booking.taken_at">-</p></div></div></div><div class="due" ratio="1" layout="row md-col sm-col"><div layout="row" justify="center" align="center" class="icon"><i class="fa fa-download"></i></div><div layout="col"><div layout="row"><h2>Due</h2><p>{{ booking.due_at | date }}</p></div><div layout="row"><h2>Returned</h2><p ng-show="booking.closed_at">{{ booking.closed_at | date }}</p><p ng-show="!booking.closed_at">-</p></div></div></div></div><section><table class="table"><tr><th>Name</th><th>Unit</th><th>Notes</th><th>Returned</th></tr><tr ng-repeat="product in booking.products"><td>{{ product.name }}</td><td><a href="#/manage/unit/{{ product.pivot.unit_id }}" ng-show="product.pivot.unit_id && user.admin">{{ unit(product.pivot.unit_id).unit_number }}</a><span ng-show="product.pivot.unit_id && !user.admin">{{ unit(product.pivot.unit_id).unit_number }}</span></td><td>{{ product.pivot.notes }}</td><td>{{ product.pivot.returned_at | date }}</td></tr></table></section></div></div>'),e.put("components/guest/login/login.html",'<header class="page-header"><h1>Login</h1></header><div class="page-content"><alert type="danger" icon="exclamation-circle" text="{{ error }}" ng-show="error"></alert><form ng-submit="login()"><div class="form-group"><label for="email">Email</label><input type="text" id="email" ng-model="email" class="form-control"></div><div class="form-group"><label for="password">Password</label><input type="password" id="password" ng-model="password" class="form-control"></div><div class="form-group"><input type="submit" class="btn btn-primary" value="Login"></div></form></div>'),e.put("components/guest/register/register.html",'<header class="page-header"><h1>Register</h1></header><div class="page-content"><alert type="danger" icon="exclamation-circle" text="{{ error }}" ng-show="error"></alert><form ng-submit="register()"><div layout="row sm-col" class="spaced-row"><div class="form-group" ratio="1"><label for="name">Name</label><input type="text" id="name" ng-model="name" class="form-control"></div><div class="form-group" ratio="1"><label for="email">Email Address</label><input type="email" id="email" ng-model="email" class="form-control"></div></div><div layout="row sm-col" class="spaced-row"><div class="form-group" ratio="1"><label for="phone">Phone Number</label><input type="text" id="phone" ng-model="phone" class="form-control"></div><div class="form-group" ratio="1"><label for="dob">DOB</label><input type="text" id="dob" ng-model="user.dob" class="form-control" uib-datepicker-popup="{{ dateOptions.format }}" is-open="openDobDate" datepicker-options="dateOptions" ng-click="openDob()"></div></div><div layout="row sm-col" class="spaced-row"><div class="form-group" ratio="1"><label for="id_number">Student ID Number</label><input type="text" id="id_number" ng-model="id_number" class="form-control"></div><div class="form-group" ratio="1"><label for="group">Class</label><ui-select ng-model="selected.group" id="group"><ui-select-match allow-clear="false" placeholder="​"><span ng-bind="$select.selected.code" class="setheight"></span></ui-select-match><ui-select-choices repeat="group in (groups | filter: $select.search) track by group.id"><div ng-bind-html="group.code | highlight: $select.search"></div><small ng-bind-html="group.type.name | highlight: $select.search"></small></ui-select-choices></ui-select></div></div><div layout="row sm-col" class="spaced-row"><div class="form-group" ratio="1"><label for="password">Password</label><input type="password" id="password" ng-model="password" class="form-control"></div><div class="form-group" ratio="1"><label for="confirm_password">Confirm Password</label><input type="password" id="confirm_password" ng-model="confirm_password" class="form-control"></div></div><div class="form-group"><input type="submit" class="btn btn-primary" value="Register"></div></form></div>'),e.put("components/manage/manage/manage.html",'<header class="page-header"><h1>Manage Data</h1></header><breadcrumbs></breadcrumbs><div class="page-content"><p>Here you can manage aspects of the booking system.</p><div ng-show="user.admin === 2" style="list-group"><a class="list-group-item list-group-item-action" layout="row" justify="between" href="#/manage/user"><span><i class="fa fa-wrench push-right"></i> Users</span><span class="label label-dark label-pill">{{ store.users.length }}</span></a><a class="list-group-item list-group-item-action" layout="row" justify="between" href="#/manage/class_type"><span><i class="fa fa-wrench push-right"></i> Class Types</span><span class="label label-dark label-pill">{{ store.group_types.length }}</span></a><a class="list-group-item list-group-item-action" layout="row" justify="between" href="#/manage/class"><span><i class="fa fa-wrench push-right"></i> Classes</span><span class="label label-dark label-pill">{{ store.groups.length }}</span></a><a class="list-group-item list-group-item-action" layout="row" justify="between" href="#/manage/product_type"><span><i class="fa fa-wrench push-right"></i> Product Types</span><span class="label label-dark label-pill">{{ store.product_types.length }}</span></a><a class="list-group-item list-group-item-action" layout="row" justify="between" href="#/manage/product"><span><i class="fa fa-wrench push-right"></i> Products</span><span class="label label-dark label-pill">{{ store.products.length }}</span></a><a class="list-group-item list-group-item-action" layout="row" justify="between" href="#/manage/unit"><span><i class="fa fa-wrench push-right"></i> Units</span><span class="label label-dark label-pill">{{ store.units.length }}</span></a></div><div ng-show="user.admin === 1" style="list-group"><li class="list-group-item"><a href="#/manage/user">Manage Users</a></li></div></div>'),e.put("components/manage/class_types/views/edit.html",'<header class="page-header" layout="row" justify="between" align="center"><h1>{{ type.name }}</h1><btn type="primary" icon="floppy-o" ng-click="save()">Save</btn></header><breadcrumbs></breadcrumbs><div class="page-content"><form ng-submit="save()"><div class="form-group"><label for="code">Code</label><input type="text" id="code" ng-model="type.code" class="form-control"></div><div class="form-group"><label for="name">Name</label><input type="text" id="name" ng-model="type.name" class="form-control"></div></form></div>'),e.put("components/manage/class_types/views/manage.html",'<header class="page-header" layout="row" justify="between" align="center"><h1>All Class Types</h1><btn icon="plus" url="#/manage/class_type/new">New</btn></header><breadcrumbs></breadcrumbs><filter model="filter" filtered="filtered"></filter><div class="page-content"><table class="table table-hover table-filtered" ng-hide="!filtered.length"><thead><tr><th class="table-col-code">Code</th><th class="table-col-name">Name</th><th class="table-col-name">No of Classes</th><!-- <th class="table-col-controls"></th> --></tr></thead><tbody><tr ng-repeat="type in group_types | filter: filter | page : 10 : 30 as filtered"><td><a href="#/manage/class_type/{{ type.id }}">{{ type.code }}</a></td><td>{{ type.name }}</td><td>{{ type.groups.length }}</td><!-- <td><btn url="#/manage/class_type/{{ type.id }}" type="info" icon="arrow-right" small>View</btn></td> --></tr></tbody></table><pager current="page" limit="10" data="group_types" filtered="filtered" filter="filter" ng-show="!filter && group_types.length >= 30"></pager></div>'),e.put("components/manage/class_types/views/new.html",'<header class="page-header" layout="row" justify="between" align="center"><h1>New Class Type</h1><btn type="primary" icon="floppy-o" ng-click="save()">Save</btn></header><breadcrumbs></breadcrumbs><div class="page-content"><form ng-submit="save()"><div class="form-group"><label for="code">Code</label><input type="text" id="code" ng-model="code" class="form-control"></div><div class="form-group"><label for="name">Name</label><input type="text" id="name" ng-model="name" class="form-control"></div></form></div>'),e.put("components/manage/class_types/views/view.html",'<header class="page-header" layout="row" align="center" justify="between"><h1>{{ type.code }}</h1><div class="btn-group"><a href="#/manage/class_type/{{ type.id }}/edit" class="btn btn-primary btn-icon"><i class="fa fa-pencil"></i>Edit</a><button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="sr-only">Toggle Dropdown</span></button><div class="dropdown-menu dropdown-menu-right"><span class="dropdown-item btn-icon" ng-click="delete()"><i class="fa fa-trash"></i>Delete</span></div></div></header><breadcrumbs></breadcrumbs><div class="page-content"><table class="table data-table"><tr><td class="row-property">Code</td><td class="row-value">{{ type.code }}</td></tr><tr><td class="row-property">Name</td><td class="row-value">{{ type.name }}</td></tr><tr><td class="row-property">Classes ({{ type.groups.length }})<br><a href="#/manage/class/new?type={{ type.code }}" class="btn push-down btn-primary btn-sm"><i class="fa fa-plus"></i></a></td><td class="row-value"><ul ng-show="type.groups.length"><li ng-repeat="group in type.groups"><a href="#/manage/class/{{ group.id }}">{{ group.code }}</a></li></ul><alert type="info" text="No classes with this type" icon="exclamation-circle" ng-if="!type.groups.length"><btn url="#/manage/class/new?type={{ type.code }}" small icon="plus">Create one</btn></alert></td></tr></table></div>'),
e.put("components/manage/classes/views/allowed_products.html",'<header class="page-header" layout="row" justify="between" align="center"><h1>{{ group.code }}</h1><div><btn type="info" icon="floppy-o" ng-show="saved === undefined">Autosave on</btn><btn type="info" icon="cog" ng-show="!saved && saved !== undefined" spinning>Saving</btn><btn type="success" icon="check" ng-show="saved">Saved</btn></div></header><breadcrumbs></breadcrumbs><filter model="filter" filtered="filtered"></filter><div class="page-content"><table class="table table-hover table-striped middle-table" ng-hide="!filtered.length"><thead><tr><th class="table-col-checkbox"></th><th class="table-col-code">Name</th><th class="table-col-code">Type</th><th class="table-col-code">Units</th><th class="table-col-short-input">Quantity</th><th class="table-col-short-input">Days</th></tr></thead><tbody><tr ng-repeat="product in products | filter: filter as filtered"><td><input type="checkbox" ng-model="product._allowed" ng-change="allow(product)"></td><td><a href="#/manage/product/{{ product.id }}">{{ product.name }}</a></td><td><a href="#/manage/product_type/{{ product.type.id }}">{{ product.type.name }}</a></td><td>{{ product.units.length }}</td><td><input type="number" ng-model="product._quantity" ng-change="update(product)" max="{{ product.units.length }}" min="1" class="form-control form-control-sm"></td><td><input type="number" ng-model="product._days_allowed" ng-change="update(product)" min="1" class="form-control form-control-sm"></td></tr></tbody></table></div>'),e.put("components/manage/classes/views/edit.html",'<header class="page-header" layout="row" justify="between" align="center"><h1>{{ group.code }}</h1><btn type="primary" icon="floppy-o" ng-click="save()">Save</btn></header><breadcrumbs></breadcrumbs><div class="page-content"><form ng-submit="save()"><div class="form-group"><label for="code">Code</label><input type="text" id="code" ng-model="group.code" class="form-control"></div><div class="form-group"><label for="type">Type</label><ui-select ng-model="selected.type" id="type"><ui-select-match allow-clear="false" placeholder="​"><span ng-bind="$select.selected.code + ($select.selected.code ? \' - \' : \'\') + $select.selected.name" class="setheight"></span></ui-select-match><ui-select-choices repeat="type in (types | filter: $select.search) track by type.id"><div ng-bind-html="type.code + \' - \' + type.name | highlight: $select.search"></div></ui-select-choices></ui-select></div><section><div class="form-group"><label>Tutors</label><ul class="no-bullets"><li layout="row" class="spaced-row pad-down" ng-repeat="tutor in selected.tutors"><ui-select ng-model="selected.tutors[$index]" ratio="1"><ui-select-match allow-clear="false" placeholder="​"><span ng-bind="$select.selected.name" class="setheight"></span></ui-select-match><ui-select-choices repeat="user in (users | filter: tutorRole | filter: $select.search) track by user.id"><div ng-bind-html="user.name | highlight: $select.search"></div></ui-select-choices></ui-select><btn type="danger" icon="times" ng-click="removeTutor(tutor)"></btn></li></ul><btn type="info" icon="plus" ng-click="addTutor()">Add Tutor</btn></div></section></form></div>'),e.put("components/manage/classes/views/manage.html",'<header class="page-header" layout="row" justify="between" align="center"><h1>All Classes</h1><btn icon="plus" url="#/manage/class/new">New</btn></header><breadcrumbs></breadcrumbs><filter model="filter" filtered="filtered"></filter><div class="page-content"><table class="table table-hover table-filtered" ng-hide="!filtered.length"><thead><tr><th class="table-col-code">Code</th><th class="table-col-name">Type</th><!-- <th class="table-col-controls"></th> --></tr></thead><tbody><tr ng-repeat="group in groups | filter: filter | page : page : 10 : 30 as filtered"><td><a href="#/manage/class/{{ group.id }}">{{ group.code }}</a></td><td><a href="#/manage/class_type/{{ group.type.id }}">{{ group.type.name }}</a></td><!-- <td><btn url="#/manage/class/{{ group.id }}" type="info" icon="arrow-right" small>View</btn></td> --></tr></tbody></table><pager current="page" limit="10" data="groups" filtered="filtered" filter="filter" ng-show="!filter && groups.length >= 30"></pager></div>'),e.put("components/manage/classes/views/new.html",'<header class="page-header" layout="row" justify="between" align="center"><h1>New Class</h1><btn type="primary" icon="floppy-o" ng-click="save()">Save</btn></header><breadcrumbs></breadcrumbs><div class="page-content"><form ng-submit="save()"><div class="form-group"><label for="code">Code</label><input type="text" id="code" ng-model="code" class="form-control" placeholder="eg. 16ADWE02B"></div><div class="form-group"><label for="type">Type</label><ui-select ng-model="selected.type" id="type"><ui-select-match allow-clear="false" placeholder="​"><span ng-bind="$select.selected.code + ($select.selected.code ? \' - \' : \'\') + $select.selected.name" class="setheight"></span></ui-select-match><ui-select-choices repeat="type in (types | filter: $select.search) track by type.id"><div ng-bind-html="type.code + \' - \' + type.name | highlight: $select.search"></div></ui-select-choices></ui-select></div><section><div class="form-group"><div layout="row" align="start" class="pad-down spaced-row"><label>Tutors</label><btn type="info" small icon="plus" ng-click="addTutor()"></btn></div><ul class="no-bullets"><li layout="row" class="spaced-row pad-down" ng-repeat="tutor in selected.tutors"><ui-select ng-model="selected.tutors[$index]" ratio="1"><ui-select-match allow-clear="false" placeholder="​"><span ng-bind="$select.selected.name" class="setheight"></span></ui-select-match><ui-select-choices repeat="user in (users | filter: tutorRole | filter: $select.search) track by user.id"><div ng-bind-html="user.name | highlight: $select.search"></div></ui-select-choices></ui-select><btn type="danger" icon="times" ng-click="removeTutor(tutor)"></btn></li></ul></div></section></form></div>'),e.put("components/manage/classes/views/view.html",'<header class="page-header" layout="row" align="center" justify="between"><h1>{{ group.code }}</h1><div class="btn-group"><a href="#/manage/class/{{ group.id }}/edit" class="btn btn-primary btn-icon"><i class="fa fa-pencil"></i>Edit</a><button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="sr-only">Toggle Dropdown</span></button><div class="dropdown-menu dropdown-menu-right"><a href="#/manage/class/{{ group.id }}/allowed_products" class="dropdown-item btn-icon"><i class="fa fa-camera"></i>Allowed Products</a><span class="dropdown-item btn-icon" ng-click="delete()"><i class="fa fa-trash"></i>Delete</span></div></div></header><breadcrumbs></breadcrumbs><div class="page-content"><table class="table data-table"><tr><td class="row-property">Code</td><td class="row-value">{{ group.code }}</td></tr><tr><td class="row-property">Type</td><td class="row-value"><a href="#/manage/class_type/{{ group.type.id }}">{{ group.type.name }}</a></td></tr><tr><td class="row-property">Tutor<span ng-show="group.tutors.length > 1">s</span></td><td class="row-value"><ul ng-show="group.tutors.length > 1"><li ng-repeat="user in group.tutors"><a href="#/manage/user/{{ user.id }}">{{ user.name }}</a></li></ul><a href="#/manage/user/{{ group.tutors[0].id }}" ng-show="group.tutors.length == 1">{{ group.tutors[0].name }}</a></td></tr><tr><td class="row-property">Bookings</td><td class="row-value"><a href="#/bookings?group={{ group.code }}">View all bookings by this class</a></td></tr><tr><td class="row-property">Students ({{ group.users.length }})<br><a href="#/manage/user/new?class={{ group.code }}" class="btn push-down btn-primary btn-sm"><i class="fa fa-plus"></i></a></td><td class="row-value"><ul><li ng-repeat="user in group.users"><a href="#/manage/user/{{ user.id }}">{{ user.name }}</a></li></ul><alert type="info" text="No students in this class" icon="exclamation-circle" ng-if="!group.users.length"><btn url="#/manage/user/new?class={{ group.code }}" small icon="plus">Create one</btn></alert></td></tr><tr><td class="row-property">Allowed Prods ({{ group.allowed_products.length }})<br><a href="#/manage/class/{{ group.id }}/allowed_products" class="btn push-down btn-primary btn-sm"><i class="fa fa-plus"></i></a></td><td class="row-value"><div ng-show="group.allowed_products.length" layout="row" align="start" justify="between"><ul><li ng-repeat="product in group.allowed_products"><a href="#/manage/product/{{ product.id }}">{{ product.name }}</a></li></ul></div><alert type="info" text="This class is not allowed to book anything" icon="exclamation-circle" ng-if="!group.allowed_products.length"></alert></td></tr></table></div>'),e.put("components/manage/product_types/views/edit.html",'<header class="page-header" layout="row" justify="between" align="center"><h1>{{ type.name }}</h1><btn type="primary" icon="floppy-o" ng-click="save()">Save</btn></header><breadcrumbs></breadcrumbs><div class="page-content"><form ng-submit="save()"><div class="form-group"><label for="name">Name</label><input type="text" id="name" ng-model="type.name" class="form-control"></div></form></div>'),e.put("components/manage/product_types/views/manage.html",'<header class="page-header" layout="row" justify="between" align="center"><h1>All Product Types</h1><btn icon="plus" url="#/manage/product_type/new">New</btn></header><breadcrumbs></breadcrumbs><filter model="filter" filtered="filtered"></filter><div class="page-content"><table class="table table-hover table-filtered" ng-hide="!filtered.length"><thead><tr><th class="table-col-name">Name</th><th class="table-col-name">No of Products</th><!-- <th class="table-col-controls"></th> --></tr></thead><tbody><tr ng-repeat="type in product_types | filter: filter | page : page : 10 : 30 as filtered"><td><a href="#/manage/product_type/{{ type.id }}">{{ type.name }}</a></td><td>{{ type.products.length }}</td><!-- <td><btn url="#/manage/product_type/{{ type.id }}" type="info" icon="arrow-right" small>View</btn></td> --></tr></tbody></table><pager current="page" limit="10" data="product_types" filtered="filtered" filter="filter" ng-show="!filter && product_types.length >= 30"></pager></div>'),e.put("components/manage/product_types/views/new.html",'<header class="page-header" layout="row" justify="between" align="center"><h1>New Product Type</h1><btn type="primary" icon="floppy-o" ng-click="save()">Save</btn></header><breadcrumbs></breadcrumbs><div class="page-content"><form ng-submit="save()"><div class="form-group"><label for="name">Name</label><input type="text" id="name" ng-model="name" class="form-control"></div></form></div>'),e.put("components/manage/product_types/views/view.html",'<header class="page-header" layout="row" align="center" justify="between"><h1>{{ type.name }}</h1><div class="btn-group"><a href="#/manage/product_type/{{ type.id }}/edit" class="btn btn-primary btn-icon"><i class="fa fa-pencil"></i>Edit</a><button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="sr-only">Toggle Dropdown</span></button><div class="dropdown-menu dropdown-menu-right"><span class="dropdown-item btn-icon" ng-click="delete()"><i class="fa fa-trash"></i>Delete</span></div></div></header><breadcrumbs></breadcrumbs><div class="page-content"><table class="table data-table"><tr><td class="row-property">Name</td><td class="row-value">{{ type.name }}</td></tr><tr><td class="row-property">Products ({{ type.products.length }})<br><a href="#/manage/product/new?type={{ type.name }}" class="btn push-down btn-primary btn-sm"><i class="fa fa-plus"></i></a></td><td class="row-value"><ul><li ng-repeat="product in type.products"><a href="#/manage/product/{{ product.id }}">{{ product.name }}</a></li></ul><alert type="info" text="No products with this type" icon="exclamation-circle" ng-if="!type.products.length"><btn url="#/manage/product/new?type={{ type.name }}" small icon="plus">Create one</btn></alert></td></tr></table></div>'),e.put("components/manage/products/views/edit.html",'<header class="page-header" layout="row" justify="between" align="center"><h1>{{ product.name }}</h1><btn type="primary" icon="floppy-o" ng-click="save()">Save</btn></header><breadcrumbs></breadcrumbs><div class="page-content"><form ng-submit="save()"><div class="form-group"><label for="name">Name</label><input type="text" id="name" ng-model="product.name" class="form-control"></div><div class="form-group"><label for="type">Type</label><ui-select ng-model="selected.type" id="type"><ui-select-match allow-clear="false" placeholder="​"><span ng-bind="$select.selected.name" class="setheight"></span></ui-select-match><ui-select-choices repeat="type in (types | filter: $select.search) track by type.id"><div ng-bind-html="type.name | highlight: $select.search"></div></ui-select-choices></ui-select></div><div class="form-group"><label>Limitless<input type="checkbox" ng-model="product.limitless" ng-true-value="1" ng-false-value="0" class="push-left"></label></div></form></div>'),e.put("components/manage/products/views/manage.html",'<header class="page-header" layout="row" justify="between" align="center"><h1>All Products</h1><btn icon="plus" url="#/manage/product/new">New</btn></header><breadcrumbs></breadcrumbs><filter model="filter" filtered="filtered"></filter><div class="page-content"><table class="table table-hover table-filtered" ng-hide="!filtered.length"><thead><tr><th class="table-col-code">Name</th><th class="table-col-name" width="30%">Type</th><!-- <th class="table-col-controls" width="10%"></th> --></tr></thead><tbody><tr ng-repeat="product in products | filter: filter | page : page : 10 : 30 as filtered"><td><a href="#/manage/product/{{ product.id }}">{{ product.name }}</a></td><td><a href="#/manage/product_type/{{ product.type.id }}">{{ product.type.name }}</a></td><!-- <td><btn url="#/manage/product/{{ product.id }}" type="info" icon="arrow-right" small>View</btn></td> --></tr></tbody></table><pager current="page" limit="10" data="products" filtered="filtered" filter="filter" ng-show="!filter && products.length >= 30"></pager></div>'),e.put("components/manage/products/views/new.html",'<header class="page-header" layout="row" justify="between" align="center"><h1>New Product</h1><btn type="primary" icon="floppy-o" ng-click="save()">Save</btn></header><breadcrumbs></breadcrumbs><div class="page-content"><form ng-submit="save()"><div class="form-group"><label for="name">Name</label><input type="text" id="name" ng-model="name" class="form-control"></div><div class="form-group"><label for="type">Type</label><ui-select ng-model="selected.type" id="type"><ui-select-match allow-clear="false" placeholder="​"><span ng-bind="$select.selected.name" class="setheight"></span></ui-select-match><ui-select-choices repeat="type in (types | filter: $select.search) track by type.id"><div ng-bind-html="type.name | highlight: $select.search"></div></ui-select-choices></ui-select></div><div class="form-group"><label>Limitless<input type="checkbox" ng-model="product.limitless" ng-true-value="1" ng-false-value="0" class="push-left"></label></div></form></div>'),e.put("components/manage/products/views/view.html",'<header class="page-header" layout="row" justify="between" align="center"><h1>{{ product.name }}</h1><div class="btn-group"><a href="#/manage/product/{{ product.id }}/edit" class="btn btn-primary btn-icon"><i class="fa fa-pencil"></i>Edit</a><button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="sr-only">Toggle Dropdown</span></button><div class="dropdown-menu dropdown-menu-right"><span class="dropdown-item btn-icon" ng-click="delete()"><i class="fa fa-trash"></i>Delete</span></div></div></header><breadcrumbs></breadcrumbs><div class="page-content"><table class="table data-table"><tr><td class="row-property">Name</td><td class="row-value">{{ product.name }}</td></tr><tr><td class="row-property">Type</td><td class="row-value"><a href="#/manage/product_type/{{ product.type.id }}">{{ product.type.name }}</a></td></tr><tr><td class="row-property">Limitless</td><td class="row-value">{{ product.limitless ? \'Yes\' : \'No\' }}</td></tr><tr><td class="row-property">Units ({{ product.units.length }})<br><a href="#/manage/unit/new?product={{ product.id }}" class="btn push-down btn-primary btn-sm"><i class="fa fa-plus"></i></a></td><td class="row-value"><ul><li ng-repeat="unit in product.units"><a href="#/manage/unit/{{ unit.id }}">{{ unit.unit_number }}</a></li></ul><alert type="info" text="No units for this product" icon="exclamation-circle" ng-if="!product.units.length"><btn url="#/manage/unit/new?product={{ product.id }}" small icon="plus">Create one</btn></alert></td></tr><tr><td class="row-property">Classes ({{ product.groups_allowed.length }})</td><td class="row-value"><div layout="row" align="start" justify="between" ng-show="product.groups_allowed.length"><ul><li ng-repeat="group in product.groups_allowed"><a href="#/manage/class/{{ group.id }}">{{ group.code }}</a></li></ul></div><alert type="info" text="No classes are allowed to book this product. Go to a class to allow this product." icon="exclamation-circle" ng-if="!product.groups_allowed.length"></alert></td></tr></table></div>'),e.put("components/manage/units/views/edit.html",'<header class="page-header" layout="row" justify="between" align="center"><h1>{{ unit.unit_number }}</h1><btn type="primary" icon="floppy-o" ng-click="save()">Save</btn></header><breadcrumbs></breadcrumbs><div class="page-content"><form ng-submit="save()"><div class="form-group"><label for="unit_number">Unit No</label><input type="text" id="unit_number" ng-model="unit.unit_number" class="form-control"></div><div class="form-group"><label for="serial_number">Serial No</label><input type="text" id="serial_number" ng-model="unit.serial_number" class="form-control"></div><div class="form-group"><label for="asset_number">Asset No</label><input type="text" id="asset_number" ng-model="unit.asset_number" class="form-control"></div><div class="form-group"><label for="product">Product</label><ui-select ng-model="selected.product" id="product"><ui-select-match allow-clear="false" placeholder="​"><span ng-bind="$select.selected.name" class="setheight"></span></ui-select-match><ui-select-choices repeat="product in (products | filter: $select.search) track by product.id"><div ng-bind-html="product.name | highlight: $select.search"></div></ui-select-choices></ui-select></div><div class="form-group"><label for="notes">Notes</label><textarea id="notes" ng-model="unit.notes" class="form-control"></textarea></div></form></div>'),e.put("components/manage/units/views/manage.html",'<header class="page-header" layout="row" justify="between" align="center"><h1>All Units</h1><btn icon="plus" url="#/manage/unit/new">New</btn></header><breadcrumbs></breadcrumbs><filter model="filter" filtered="filtered"></filter><div class="page-content"><table class="table table-hover table-filtered" ng-hide="!filtered.length"><thead><tr><th class="table-col-name" width="10%">Unit No</th><th class="table-col-code" width="10%">Serial No</th><th class="table-col-name" width="10%">Asset No</th><th class="table-col-name">Product</th><!-- <th class="table-col-controls" width="10%"></th> --></tr></thead><tbody><tr ng-repeat="unit in units | filter: filter | page: page : 10 : 30 as filtered"><td><a href="#/manage/unit/{{ unit.id }}">{{ unit.unit_number }}</a></td><td>{{ unit.serial_number }}</td><td>{{ unit.asset_number }}</td><td><a href="#/manage/product/{{ unit.product.id }}">{{ unit.product.name }}</a></td><!-- <td><btn url="#/manage/unit/{{ unit.id }}" type="info" icon="arrow-right" small>View</btn></td> --></tr></tbody></table><pager current="page" limit="10" data="units" filtered="filtered" filter="filter" ng-show="!filter && units.length >= 30"></pager></div>'),e.put("components/manage/units/views/new.html",'<header class="page-header" layout="row" justify="between" align="center"><h1>New Unit</h1><btn type="primary" icon="floppy-o" ng-click="save()">Save</btn></header><breadcrumbs></breadcrumbs><div class="page-content"><form ng-submit="save()"><div class="form-group"><label for="unit_number">Unit No</label><input type="text" id="unit_number" ng-model="unit_number" class="form-control"></div><div class="form-group"><label for="serial_number">Serial No</label><input type="text" id="serial_number" ng-model="serial_number" class="form-control"></div><div class="form-group"><label for="asset_number">Asset No</label><input type="text" id="asset_number" ng-model="asset_number" class="form-control"></div><div class="form-group"><label for="product">Product</label><ui-select ng-model="selected.product" id="product"><ui-select-match allow-clear="false" placeholder="​"><span ng-bind="$select.selected.name" class="setheight"></span></ui-select-match><ui-select-choices repeat="product in (products | filter: $select.search) track by product.id"><div ng-bind-html="product.name | highlight: $select.search"></div></ui-select-choices></ui-select></div><div class="form-group"><label for="notes">Notes</label><textarea id="notes" ng-model="notes" class="form-control"></textarea></div></form></div>'),e.put("components/manage/units/views/view.html",'<header class="page-header" layout="row" align="center" justify="between"><h1>{{ unit.product.name }}: {{ unit.unit_number }}</h1><div class="btn-group"><a href="#/manage/unit/{{ unit.id }}/edit" class="btn btn-primary btn-icon"><i class="fa fa-pencil"></i>Edit</a><button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="sr-only">Toggle Dropdown</span></button><div class="dropdown-menu dropdown-menu-right"><span class="dropdown-item btn-icon" ng-click="delete()"><i class="fa fa-trash"></i>Delete</span></div></div></header><breadcrumbs></breadcrumbs><div class="page-content"><table class="table data-table"><tr><td class="row-property">Unit No</td><td class="row-value">{{ unit.unit_number ? unit.unit_number : \'-\' }}</td></tr><tr><td class="row-property">Serial No</td><td class="row-value">{{ unit.serial_number ? unit.serial_number : \'-\' }}</td></tr><tr><td class="row-property">Asset No</td><td class="row-value">{{ unit.asset_number ? unit.asset_number : \'-\' }}</td></tr><tr><td class="row-property">Product</td><td class="row-value"><a href="#/manage/product/{{ unit.product.id }}">{{ unit.product.name }}</a></td></tr><tr><td class="row-property">Notes</td><td class="row-value">{{ unit.notes ? unit.notes : \'-\' }}</td></tr></table></div>'),e.put("components/manage/users/views/edit.html",'<header class="page-header" layout="row" align="center" justify="between"><h1><span ng-show="!profileMode">{{ user.name }}</span><span ng-show="profileMode">Edit Profile</span></h1><btn type="primary" icon="floppy-o" ng-click="save()">Save</btn></header><breadcrumbs ng-hide="profileMode"></breadcrumbs><div class="page-content"><alert type="danger" icon="exclamation-triangle" text="{{ error }}" ng-show="error"></alert><form ng-submit="save()"><div layout="row sm-col" class="spaced-row"><div class="form-group" ratio="1"><label for="name">Name</label><input type="text" id="name" ng-model="user.name" class="form-control"></div><div class="form-group" ratio="1"><label for="email">Email Address</label><input type="email" id="email" ng-model="user.email" class="form-control"></div></div><div layout="row sm-col" class="spaced-row"><div class="form-group" ratio="1"><label for="phone">Phone Number</label><input type="text" id="phone" ng-model="user.phone" class="form-control"></div><div class="form-group" ratio="1"><label for="dob">DOB</label><input type="text" id="dob" ng-model="user.dob" class="form-control" uib-datepicker-popup="{{ dateOptions.format }}" is-open="openDobDate" datepicker-options="dateOptions" ng-click="openDob()"></div></div><div layout="row sm-col" class="spaced-row" ng-show="profileMode"><div class="form-group" ratio="1"><label for="password">Password</label><input type="password" id="password" ng-model="password" class="form-control"></div><div class="form-group" ratio="1"><label for="confirm_password">Confirm Password</label><input type="password" id="confirm_password" ng-model="confirm_password" class="form-control"></div></div><div layout="row sm-col" class="spaced-row" ng-hide="profileMode || you.id == user.id"><div class="form-group" ratio="1"><label for="group">Role</label><ui-select ng-model="selected.role" id="role"><ui-select-match allow-clear="false" placeholder="​"><span ng-bind="$select.selected.text" class="setheight"></span></ui-select-match><ui-select-choices repeat="role in (roles | filter: $select.search) track by role.level"><div ng-bind-html="role.text | highlight: $select.search"></div></ui-select-choices></ui-select></div></div><div layout="row sm-col" class="spaced-row" ng-show="selected.role.level === 0 && !profileMode"><div class="form-group" ratio="1"><label for="id_number">Student ID Number</label><input type="text" id="id_number" ng-model="user.id_number" class="form-control"></div><div class="form-group" ratio="1"><label for="group">Class</label><ui-select ng-model="selected.group" id="group"><ui-select-match allow-clear="false" placeholder="​"><span ng-bind="$select.selected.code" class="setheight"></span></ui-select-match><ui-select-choices repeat="group in (groups | filter: $select.search) track by group.id"><div ng-bind-html="group.code | highlight: $select.search"></div><small ng-bind-html="group.type.name | highlight: $select.search"></small></ui-select-choices></ui-select></div></div><div layout="row sm-row" class="spaced-row" ng-show="selected.role.level === 0 && !profileMode"><div class="form-group"><label for="can_book">Can Book</label><div class="push-left"><label><input type="checkbox" ng-model="user.can_book" ng-change="syncUser()" ng-true-value="1" class="push-right"> {{ user.can_book ? \'Yes\' : \'No\' }}</label></div></div><div class="form-group" ng-show="!user.can_book" ratio="1"><label for="can_book_reason">Reason</label><input type="text" ng-model="user.can_book_reason" class="form-control" id="can_book_reason"></div></div></form></div>'),e.put("components/manage/users/views/edit_note.html",'<header class="page-header" layout="row" align="center" justify="between"><h1>Edit Note</h1><btn type="primary" icon="floppy-o" ng-click="save()">Save</btn></header><breadcrumbs></breadcrumbs><div class="page-content"><form ng-submit="save()"><label for="note-content">Note Content</label><input type="text" id="note-content" class="form form-control" ng-model="note.content"></form></div>'),e.put("components/manage/users/views/manage.html",'<header class="page-header" layout="row" justify="between" align="center"><h1>All Users</h1><btn icon="plus" url="#/manage/user/new">New</btn></header><breadcrumbs></breadcrumbs><filter model="filter" filtered="filtered"></filter><div class="page-content"><table class="table table-hover table-filtered" ng-hide="!filtered.length"><thead><tr><th class="table-col-firstname">Name</th><th class="table-col-lastname sm-hide" width="15%">Role</th><th class="table-col-lastname sm-hide" width="15%">Class</th><!-- <th class="table-col-controls sm-hide" width="10%"></th> --></tr></thead><tbody><tr ng-repeat="user in users | filter: staffFilter | filter: filter | orderBy: \'group.id\' | orderBy: \'-admin\' | page: page : 10 : 30 as filtered"><td><a href="#/manage/user/{{ user.id }}">{{ user.name }}</a></td><td class="sm-hide">{{ user._role }}</td><td class="sm-hide"><a href="#/manage/class/{{ user.group.id }}" ng-show="!user.admin">{{ user.group.code }}</a></td><!-- <td class="sm-hide"><btn url="#/manage/user/{{ user.id }}" type="info" icon="arrow-right" small>View</btn></td> --></tr></tbody></table><pager current="page" limit="10" data="users" filtered="filtered" filter="filter" ng-show="!filter && users.length >= 30"></pager></div>'),e.put("components/manage/users/views/new.html",'<header class="page-header" layout="row" align="center" justify="between"><h1>New User</h1><btn type="primary" icon="floppy-o" ng-click="save()">Save</btn></header><breadcrumbs></breadcrumbs><div class="page-content"><form ng-submit="save()"><div layout="row sm-col" class="spaced-row"><div class="form-group" ratio="1"><label for="name">Name</label><input type="text" id="name" ng-model="name" class="form-control"></div><div class="form-group" ratio="1"><label for="email">Email Address</label><input type="text" id="email" ng-model="email" class="form-control"></div></div><div layout="row sm-col" class="spaced-row"><div class="form-group" ratio="1"><label for="phone">Phone Number</label><input type="text" id="phone" ng-model="phone" class="form-control"></div><div class="form-group" ratio="1"><label for="dob">DOB</label><input type="text" id="dob" ng-model="user.dob" class="form-control" uib-datepicker-popup="{{ dateOptions.format }}" is-open="openDobDate" datepicker-options="dateOptions" ng-click="openDob()"></div></div><div layout="row sm-col" class="spaced-row" ng-show="user.admin === 2"><div class="form-group" ratio="1"><label for="group">Role</label><ui-select ng-model="selected.role" id="role"><ui-select-match allow-clear="false" placeholder="​"><span ng-bind="$select.selected.text" class="setheight"></span></ui-select-match><ui-select-choices repeat="role in (roles | filter: $select.search) track by role.level"><div ng-bind-html="role.text | highlight: $select.search"></div></ui-select-choices></ui-select></div></div><div layout="row sm-col" class="spaced-row" ng-show="selected.role.level === 0"><div class="form-group" ratio="1"><label for="id_number">Student ID Number</label><input type="text" id="id_number" ng-model="id_number" class="form-control"></div><div class="form-group" ratio="1"><label for="group">Class</label><ui-select ng-model="selected.group" id="group"><ui-select-match allow-clear="false" placeholder="​"><span ng-bind="$select.selected.code" class="setheight"></span></ui-select-match><ui-select-choices repeat="group in (groups | filter: $select.search) track by group.id"><div ng-bind-html="group.code | highlight: $select.search"></div><small ng-bind-html="group.type.name | highlight: $select.search"></small></ui-select-choices></ui-select></div></div></form></div>'),e.put("components/manage/users/views/new_note.html",'<header class="page-header" layout="row" align="center" justify="between"><h1>New Note for {{ user.name }}</h1><btn type="primary" icon="floppy-o" ng-click="save()">Save</btn></header><breadcrumbs></breadcrumbs><div class="page-content"><form ng-submit="save()"><label for="note-content">Note Content</label><input type="text" id="note-content" class="form form-control" ng-model="content"></form></div>'),e.put("components/manage/users/views/view.html",'<header class="page-header" layout="row" align="center" justify="between"><h1>{{ user.name }}</h1><div class="btn-group"><a href="#/manage/user/{{ user.id }}/edit" class="btn btn-primary btn-icon"><i class="fa fa-pencil"></i>Edit</a><button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="sr-only">Toggle Dropdown</span></button><div class="dropdown-menu dropdown-menu-right"><a class="dropdown-item btn-icon" href="#/manage/user/{{ user.id }}/reset_pw"><i class="fa fa-unlock-alt"></i>Reset Password</a><span class="dropdown-item btn-icon" ng-click="delete()"><i class="fa fa-trash"></i>Delete</span></div></div></header><breadcrumbs></breadcrumbs><div class="page-content"><table class="table data-table"><tr><td class="row-property">Name</td><td class="row-value">{{ user.name }}</td></tr><tr><td class="row-property">Phone</td><td class="row-value">{{ user.phone ? user.phone : \'-\' }}</td></tr><tr><td class="row-property">Email</td><td class="row-value"><a href="mailto:{{ user.email }}" ng-show="user.email">{{ user.email }}</a><span ng-if="!user.email">-</span></td></tr><tr><td class="row-property">DOB</td><td class="row-value">{{ user.dob | date }} ({{ user._age }} years old)</td></tr><tr><td class="row-property">Role</td><td class="row-value">{{ user._role }}</td></tr><tr ng-show="!user.admin"><td class="row-property">Student ID</td><td class="row-value">{{ user.id_number }}</td></tr><tr ng-show="!user.admin" ng-class="{\'bg-danger\': !user.can_book}"><td class="row-property">Can book</td><td class="row-value"> {{ user.can_book ? \'Yes\' : \'No\' }}<div class="bump-down" ng-show="!user.can_book"><p>Reason: <strong>{{ user.can_book_reason }}</strong></p></div></td></tr><tr><td class="row-property">Bookings</td><td class="row-value"><a href="#/bookings?user={{ user.id }}">View all bookings by this user</a></td></tr><tr ng-show="!user.admin"><td class="row-property">Class</td><td class="row-value"><a href="#/manage/class/{{ user.group.id }}">{{ user.group.code }}</a></td></tr><tr ng-show="user.admin && user.tutors_groups.length"><td class="row-property">Tutor of</td><td class="row-value"><ul><li ng-repeat="group in user.tutors_groups"><a href="#/manage/class/{{ group.id }}">{{ group.code }}</a></li></ul></td></tr><tr ng-show="!user.admin"><td class="row-property">Notes<br><a href="#/manage/user/{{ user.id }}/note/new" class="btn push-down btn-primary btn-sm"><i class="fa fa-plus"></i></a></td><td class="row-value"><div class="list-group"><div class="list-group-item user-note" ng-repeat="note in user.notes" layout="row" ng-hide="note.is_old"><div class="user-note-content" ratio="1"><a href="#/manage/user/{{ user.id }}/note/{{ note.id }}">{{ note.content }}</a></div><div class="user-note-controls"><btn icon="pencil" type="info" small url="#/manage/user/{{ user.id }}/note/{{ note.id }}/edit">Edit</btn> <btn icon="trash" type="danger" small ng-click="deleteNote(note)"></btn></div></div></div></td></tr></table></div>'),
e.put("components/manage/users/views/view_note.html",'<header class="page-header" layout="row" align="center" justify="between"><h1>View Note</h1><div class="btn-group"><a href="#/manage/user/{{ user.id }}/note/{{ note.id }}/edit" class="btn btn-primary btn-icon"><i class="fa fa-pencil"></i>Edit</a><button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="sr-only">Toggle Dropdown</span></button><div class="dropdown-menu dropdown-menu-right"><span class="dropdown-item btn-icon" ng-click="deleteNote(note)"><i class="fa fa-trash"></i>Delete</span></div></div></header><breadcrumbs></breadcrumbs><div class="page-content"><h2 class="center-text">{{ note.content }}</h2><section><table class="table data-table"><tr><td class="row-property">Written by</td><td class="row-value"><a href="#/manage/user/{{ note.writer.id }}">{{ note.writer.name }}</a></td></tr><tr><td class="row-property">Date</td><td class="row-value">{{ dateify(note.created_at) | date: \'d/M/yy h:mm a\' }}</td></tr></table></section><div ng-show="note.history.length"><h3>Note History</h3><ul class="list-group"><li ng-repeat="version in note.history" class="list-group-item"><div layout="row" justify="between"><span>{{ version.content }}</span><span><a href="#/manage/user/{{ version.writer.id }}">{{ version.writer.name }}</a> ({{ dateify(version.created_at) | date: \'d/M/yy h:mm a\' }})</span></div></li></ul></div></div>')}]);